<!DOCTYPE html>

<html>

<head>

<meta charset="utf-8" />
<meta name="generator" content="pandoc" />
<meta http-equiv="X-UA-Compatible" content="IE=EDGE" />

<meta name="viewport" content="width=device-width, initial-scale=1">

<meta name="author" content="RS-eco" />

<meta name="date" content="2019-12-20" />

<title>ISIMIP2b landuse data</title>



<style type="text/css">code{white-space: pre;}</style>
<style type="text/css" data-origin="pandoc">
a.sourceLine { display: inline-block; line-height: 1.25; }
a.sourceLine { pointer-events: none; color: inherit; text-decoration: inherit; }
a.sourceLine:empty { height: 1.2em; }
.sourceCode { overflow: visible; }
code.sourceCode { white-space: pre; position: relative; }
div.sourceCode { margin: 1em 0; }
pre.sourceCode { margin: 0; }
@media screen {
div.sourceCode { overflow: auto; }
}
@media print {
code.sourceCode { white-space: pre-wrap; }
a.sourceLine { text-indent: -1em; padding-left: 1em; }
}
pre.numberSource a.sourceLine
  { position: relative; left: -4em; }
pre.numberSource a.sourceLine::before
  { content: attr(data-line-number);
    position: relative; left: -1em; text-align: right; vertical-align: baseline;
    border: none; pointer-events: all; display: inline-block;
    -webkit-touch-callout: none; -webkit-user-select: none;
    -khtml-user-select: none; -moz-user-select: none;
    -ms-user-select: none; user-select: none;
    padding: 0 4px; width: 4em;
    color: #aaaaaa;
  }
pre.numberSource { margin-left: 3em; border-left: 1px solid #aaaaaa;  padding-left: 4px; }
div.sourceCode
  {  }
@media screen {
a.sourceLine::before { text-decoration: underline; }
}
code span.al { color: #ff0000; font-weight: bold; } /* Alert */
code span.an { color: #60a0b0; font-weight: bold; font-style: italic; } /* Annotation */
code span.at { color: #7d9029; } /* Attribute */
code span.bn { color: #40a070; } /* BaseN */
code span.bu { } /* BuiltIn */
code span.cf { color: #007020; font-weight: bold; } /* ControlFlow */
code span.ch { color: #4070a0; } /* Char */
code span.cn { color: #880000; } /* Constant */
code span.co { color: #60a0b0; font-style: italic; } /* Comment */
code span.cv { color: #60a0b0; font-weight: bold; font-style: italic; } /* CommentVar */
code span.do { color: #ba2121; font-style: italic; } /* Documentation */
code span.dt { color: #902000; } /* DataType */
code span.dv { color: #40a070; } /* DecVal */
code span.er { color: #ff0000; font-weight: bold; } /* Error */
code span.ex { } /* Extension */
code span.fl { color: #40a070; } /* Float */
code span.fu { color: #06287e; } /* Function */
code span.im { } /* Import */
code span.in { color: #60a0b0; font-weight: bold; font-style: italic; } /* Information */
code span.kw { color: #007020; font-weight: bold; } /* Keyword */
code span.op { color: #666666; } /* Operator */
code span.ot { color: #007020; } /* Other */
code span.pp { color: #bc7a00; } /* Preprocessor */
code span.sc { color: #4070a0; } /* SpecialChar */
code span.ss { color: #bb6688; } /* SpecialString */
code span.st { color: #4070a0; } /* String */
code span.va { color: #19177c; } /* Variable */
code span.vs { color: #4070a0; } /* VerbatimString */
code span.wa { color: #60a0b0; font-weight: bold; font-style: italic; } /* Warning */

</style>
<script>
// apply pandoc div.sourceCode style to pre.sourceCode instead
(function() {
  var sheets = document.styleSheets;
  for (var i = 0; i < sheets.length; i++) {
    if (sheets[i].ownerNode.dataset["origin"] !== "pandoc") continue;
    try { var rules = sheets[i].cssRules; } catch (e) { continue; }
    for (var j = 0; j < rules.length; j++) {
      var rule = rules[j];
      // check if there is a div.sourceCode rule
      if (rule.type !== rule.STYLE_RULE || rule.selectorText !== "div.sourceCode") continue;
      var style = rule.style.cssText;
      // check if color or background-color is set
      if (rule.style.color === '' && rule.style.backgroundColor === '') continue;
      // replace div.sourceCode by a pre.sourceCode rule
      sheets[i].deleteRule(j);
      sheets[i].insertRule('pre.sourceCode{' + style + '}', j);
    }
  }
})();
</script>



<style type="text/css">body {
background-color: #fff;
margin: 1em auto;
max-width: 700px;
overflow: visible;
padding-left: 2em;
padding-right: 2em;
font-family: "Open Sans", "Helvetica Neue", Helvetica, Arial, sans-serif;
font-size: 14px;
line-height: 1.35;
}
#header {
text-align: center;
}
#TOC {
clear: both;
margin: 0 0 10px 10px;
padding: 4px;
width: 400px;
border: 1px solid #CCCCCC;
border-radius: 5px;
background-color: #f6f6f6;
font-size: 13px;
line-height: 1.3;
}
#TOC .toctitle {
font-weight: bold;
font-size: 15px;
margin-left: 5px;
}
#TOC ul {
padding-left: 40px;
margin-left: -1.5em;
margin-top: 5px;
margin-bottom: 5px;
}
#TOC ul ul {
margin-left: -2em;
}
#TOC li {
line-height: 16px;
}
table {
margin: 1em auto;
border-width: 1px;
border-color: #DDDDDD;
border-style: outset;
border-collapse: collapse;
}
table th {
border-width: 2px;
padding: 5px;
border-style: inset;
}
table td {
border-width: 1px;
border-style: inset;
line-height: 18px;
padding: 5px 5px;
}
table, table th, table td {
border-left-style: none;
border-right-style: none;
}
table thead, table tr.even {
background-color: #f7f7f7;
}
p {
margin: 0.5em 0;
}
blockquote {
background-color: #f6f6f6;
padding: 0.25em 0.75em;
}
hr {
border-style: solid;
border: none;
border-top: 1px solid #777;
margin: 28px 0;
}
dl {
margin-left: 0;
}
dl dd {
margin-bottom: 13px;
margin-left: 13px;
}
dl dt {
font-weight: bold;
}
ul {
margin-top: 0;
}
ul li {
list-style: circle outside;
}
ul ul {
margin-bottom: 0;
}
pre, code {
background-color: #f7f7f7;
border-radius: 3px;
color: #333;
white-space: pre-wrap; 
}
pre {
border-radius: 3px;
margin: 5px 0px 10px 0px;
padding: 10px;
}
pre:not([class]) {
background-color: #f7f7f7;
}
code {
font-family: Consolas, Monaco, 'Courier New', monospace;
font-size: 85%;
}
p > code, li > code {
padding: 2px 0px;
}
div.figure {
text-align: center;
}
img {
background-color: #FFFFFF;
padding: 2px;
border: 1px solid #DDDDDD;
border-radius: 3px;
border: 1px solid #CCCCCC;
margin: 0 5px;
}
h1 {
margin-top: 0;
font-size: 35px;
line-height: 40px;
}
h2 {
border-bottom: 4px solid #f7f7f7;
padding-top: 10px;
padding-bottom: 2px;
font-size: 145%;
}
h3 {
border-bottom: 2px solid #f7f7f7;
padding-top: 10px;
font-size: 120%;
}
h4 {
border-bottom: 1px solid #f7f7f7;
margin-left: 8px;
font-size: 105%;
}
h5, h6 {
border-bottom: 1px solid #ccc;
font-size: 105%;
}
a {
color: #0033dd;
text-decoration: none;
}
a:hover {
color: #6666ff; }
a:visited {
color: #800080; }
a:visited:hover {
color: #BB00BB; }
a[href^="http:"] {
text-decoration: underline; }
a[href^="https:"] {
text-decoration: underline; }

code > span.kw { color: #555; font-weight: bold; } 
code > span.dt { color: #902000; } 
code > span.dv { color: #40a070; } 
code > span.bn { color: #d14; } 
code > span.fl { color: #d14; } 
code > span.ch { color: #d14; } 
code > span.st { color: #d14; } 
code > span.co { color: #888888; font-style: italic; } 
code > span.ot { color: #007020; } 
code > span.al { color: #ff0000; font-weight: bold; } 
code > span.fu { color: #900; font-weight: bold; }  code > span.er { color: #a61717; background-color: #e3d2d2; } 
</style>




</head>

<body>




<h1 class="title toc-ignore">ISIMIP2b landuse data</h1>
<h4 class="author">RS-eco</h4>
<h4 class="date">2019-12-20</h4>



<div id="data-setup" class="section level2">
<h2>Data Setup</h2>
<p>Load rISIMIP package</p>
<div class="sourceCode" id="cb1"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb1-1" data-line-number="1"><span class="kw">library</span>(rISIMIP)</a></code></pre></div>
</div>
<div id="specify-land-use-type-resolution" class="section level2">
<h2>Specify land-use type resolution</h2>
<div class="sourceCode" id="cb2"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb2-1" data-line-number="1"><span class="co"># Choose one of totals, 5crops, 15crops</span></a>
<a class="sourceLine" id="cb2-2" data-line-number="2">lu_type &lt;-<span class="st"> &quot;totals&quot;</span></a></code></pre></div>
<div class="sourceCode" id="cb3"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb3-1" data-line-number="1"><span class="co"># Specify path of file directory</span></a>
<a class="sourceLine" id="cb3-2" data-line-number="2">filedir &lt;-<span class="st"> &quot;/media/matt/Data/Documents/Wissenschaft/Data&quot;</span></a></code></pre></div>
</div>
<div id="landuse-data" class="section level2">
<h2>Landuse data</h2>
<p>The rISIMIP package already includes landuse data for 1995 and 2080 of the totals landuse data, the code of how this data is retrieved can be found in the data-raw folder of the Github repository of this package.</p>
</div>
<div id="soc-scenario" class="section level2">
<h2>2005soc Scenario</h2>
<div class="sourceCode" id="cb4"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb4-1" data-line-number="1"><span class="kw">data</span>(<span class="st">&quot;landuse-totals_2005soc&quot;</span>)</a></code></pre></div>
</div>
<div id="present-and-future-scenarios" class="section level2">
<h2>Present and future scenarios</h2>
<p>Combine all crop data</p>
<div class="sourceCode" id="cb5"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb5-1" data-line-number="1"><span class="co"># Get summarised landuse data</span></a>
<a class="sourceLine" id="cb5-2" data-line-number="2">d &lt;-<span class="st"> </span><span class="kw">data</span>(<span class="dt">package=</span><span class="st">&quot;rISIMIP&quot;</span>)</a>
<a class="sourceLine" id="cb5-3" data-line-number="3">landuse &lt;-<span class="st"> </span>d<span class="op">$</span>results[,<span class="st">&quot;Item&quot;</span>][<span class="kw">grep</span>(<span class="dt">x=</span>d<span class="op">$</span>results[,<span class="st">&quot;Item&quot;</span>], <span class="dt">pattern=</span><span class="st">&quot;landuse-totals_&quot;</span>)]</a>
<a class="sourceLine" id="cb5-4" data-line-number="4"></a>
<a class="sourceLine" id="cb5-5" data-line-number="5"><span class="co"># Read files into dataframe</span></a>
<a class="sourceLine" id="cb5-6" data-line-number="6">crops &lt;-<span class="st"> </span><span class="kw">lapply</span>(landuse, <span class="cf">function</span>(x){</a>
<a class="sourceLine" id="cb5-7" data-line-number="7">  data &lt;-<span class="st"> </span><span class="kw">get</span>(<span class="kw">data</span>(<span class="dt">list=</span>x))</a>
<a class="sourceLine" id="cb5-8" data-line-number="8">  data<span class="op">$</span>year &lt;-<span class="st"> </span><span class="kw">strsplit</span>(<span class="kw">strsplit</span>(<span class="kw">basename</span>(x), <span class="dt">split=</span><span class="st">&quot;_&quot;</span>)[[<span class="dv">1</span>]][<span class="dv">4</span>], <span class="dt">split=</span><span class="st">&quot;[.]&quot;</span>)[[<span class="dv">1</span>]][<span class="dv">1</span>]</a>
<a class="sourceLine" id="cb5-9" data-line-number="9">  data<span class="op">$</span>scenario &lt;-<span class="st"> </span><span class="kw">strsplit</span>(<span class="kw">basename</span>(x), <span class="dt">split=</span><span class="st">&quot;_&quot;</span>)[[<span class="dv">1</span>]][<span class="dv">1</span>]</a>
<a class="sourceLine" id="cb5-10" data-line-number="10">  data<span class="op">$</span>model &lt;-<span class="st"> </span><span class="kw">strsplit</span>(<span class="kw">basename</span>(x), <span class="dt">split=</span><span class="st">&quot;_&quot;</span>)[[<span class="dv">1</span>]][<span class="dv">2</span>]</a>
<a class="sourceLine" id="cb5-11" data-line-number="11">  <span class="kw">return</span>(data)</a>
<a class="sourceLine" id="cb5-12" data-line-number="12">})</a>
<a class="sourceLine" id="cb5-13" data-line-number="13">crops &lt;-<span class="st"> </span><span class="kw">do.call</span>(plyr<span class="op">::</span>rbind.fill, crops)</a>
<a class="sourceLine" id="cb5-14" data-line-number="14"></a>
<a class="sourceLine" id="cb5-15" data-line-number="15"><span class="co">#Calculate area of each cell in km2</span></a>
<a class="sourceLine" id="cb5-16" data-line-number="16"><span class="kw">data</span>(landseamask_generic, <span class="dt">package=</span><span class="st">&quot;rISIMIP&quot;</span>)</a>
<a class="sourceLine" id="cb5-17" data-line-number="17">isimip_area &lt;-<span class="st"> </span>raster<span class="op">::</span><span class="kw">area</span>(landseamask_generic, <span class="dt">na.rm=</span><span class="ot">TRUE</span>) <span class="co"># km2</span></a>
<a class="sourceLine" id="cb5-18" data-line-number="18">isimip_area &lt;-<span class="st"> </span><span class="kw">as.data.frame</span>(raster<span class="op">::</span><span class="kw">rasterToPoints</span>(isimip_area))</a>
<a class="sourceLine" id="cb5-19" data-line-number="19"><span class="kw">colnames</span>(isimip_area) &lt;-<span class="st"> </span><span class="kw">c</span>(<span class="st">&quot;x&quot;</span>, <span class="st">&quot;y&quot;</span>, <span class="st">&quot;area&quot;</span>)</a>
<a class="sourceLine" id="cb5-20" data-line-number="20"><span class="kw">sum</span>(isimip_area<span class="op">$</span>area)</a>
<a class="sourceLine" id="cb5-21" data-line-number="21"></a>
<a class="sourceLine" id="cb5-22" data-line-number="22"><span class="co"># Add area to crops dataframe</span></a>
<a class="sourceLine" id="cb5-23" data-line-number="23"><span class="kw">library</span>(dplyr)</a>
<a class="sourceLine" id="cb5-24" data-line-number="24">crops &lt;-<span class="st"> </span><span class="kw">left_join</span>(crops, isimip_area)</a>
<a class="sourceLine" id="cb5-25" data-line-number="25"></a>
<a class="sourceLine" id="cb5-26" data-line-number="26"><span class="co"># Remove 2005soc data</span></a>
<a class="sourceLine" id="cb5-27" data-line-number="27">crops &lt;-<span class="st"> </span>crops <span class="op">%&gt;%</span><span class="st"> </span><span class="kw">filter</span>(scenario <span class="op">!=</span><span class="st"> &quot;2005soc&quot;</span>)</a></code></pre></div>
<p>Create summary bar plot</p>
<div class="sourceCode" id="cb6"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb6-1" data-line-number="1"><span class="co"># Remove duplicate of 1995 data</span></a>
<a class="sourceLine" id="cb6-2" data-line-number="2"><span class="co">#crops &lt;- crops %&gt;% filter(year != 1995 | scenario != &quot;rcp60&quot;)</span></a>
<a class="sourceLine" id="cb6-3" data-line-number="3"></a>
<a class="sourceLine" id="cb6-4" data-line-number="4"><span class="co"># Calculate remaining area not considered by land-use types</span></a>
<a class="sourceLine" id="cb6-5" data-line-number="5">crops<span class="op">$</span>other &lt;-<span class="st"> </span><span class="dv">1</span> <span class="op">-</span><span class="st"> </span>(crops <span class="op">%&gt;%</span><span class="st"> </span>dplyr<span class="op">::</span><span class="kw">select</span>(<span class="op">-</span><span class="kw">c</span>(x,y,area, year, scenario, model, <span class="kw">matches</span>(<span class="st">&quot;total&quot;</span>))) <span class="op">%&gt;%</span><span class="st"> </span></a>
<a class="sourceLine" id="cb6-6" data-line-number="6"><span class="st">                      </span><span class="kw">rowSums</span>(<span class="dt">na.rm=</span><span class="ot">TRUE</span>))</a>
<a class="sourceLine" id="cb6-7" data-line-number="7"></a>
<a class="sourceLine" id="cb6-8" data-line-number="8"><span class="co"># Calculate total area per category and turn into long format</span></a>
<a class="sourceLine" id="cb6-9" data-line-number="9">crops_sum &lt;-<span class="st"> </span>crops <span class="op">%&gt;%</span><span class="st"> </span></a>
<a class="sourceLine" id="cb6-10" data-line-number="10"><span class="st">  </span><span class="kw">mutate_at</span>(<span class="kw">vars</span>(<span class="op">-</span><span class="kw">c</span>(x,y,area,year,scenario,model)), <span class="kw">funs</span>(. <span class="op">*</span><span class="st"> </span>area)) <span class="op">%&gt;%</span><span class="st"> </span></a>
<a class="sourceLine" id="cb6-11" data-line-number="11"><span class="st">  </span><span class="kw">group_by</span>(year, scenario, model) <span class="op">%&gt;%</span><span class="st"> </span><span class="kw">summarise_at</span>(<span class="kw">vars</span>(<span class="op">-</span><span class="kw">c</span>(x,y,area)), sum) <span class="op">%&gt;%</span><span class="st"> </span></a>
<a class="sourceLine" id="cb6-12" data-line-number="12"><span class="st">  </span>dplyr<span class="op">::</span><span class="kw">select</span>(<span class="op">-</span><span class="kw">matches</span>(<span class="st">&quot;total&quot;</span>)) <span class="op">%&gt;%</span><span class="st"> </span><span class="kw">filter</span>(year <span class="op">&lt;</span><span class="st"> </span><span class="dv">2090</span>) <span class="op">%&gt;%</span><span class="st"> </span></a>
<a class="sourceLine" id="cb6-13" data-line-number="13"><span class="st">  </span>tidyr<span class="op">::</span><span class="kw">gather</span>(var, value, <span class="op">-</span><span class="kw">c</span>(year, scenario, model)) <span class="op">%&gt;%</span><span class="st"> </span></a>
<a class="sourceLine" id="cb6-14" data-line-number="14"><span class="st">  </span>tidyr<span class="op">::</span><span class="kw">unite</span>(time_rcp, year, <span class="dt">sep=</span><span class="st">&quot; &quot;</span>)<span class="co"># Adapt unite accordingly</span></a>
<a class="sourceLine" id="cb6-15" data-line-number="15"></a>
<a class="sourceLine" id="cb6-16" data-line-number="16"><span class="co"># Calculate mean across models</span></a>
<a class="sourceLine" id="cb6-17" data-line-number="17">crops_mean &lt;-<span class="st"> </span>crops_sum <span class="op">%&gt;%</span><span class="st"> </span><span class="kw">group_by</span>(time_rcp, var, scenario) <span class="op">%&gt;%</span><span class="st"> </span></a>
<a class="sourceLine" id="cb6-18" data-line-number="18"><span class="st">  </span>dplyr<span class="op">::</span><span class="kw">summarise</span>(<span class="dt">mean=</span><span class="kw">mean</span>(value, <span class="dt">na.rm=</span>T))</a>
<a class="sourceLine" id="cb6-19" data-line-number="19">crops_mean &lt;-<span class="st"> </span>tidyr<span class="op">::</span><span class="kw">drop_na</span>(crops_mean)</a>
<a class="sourceLine" id="cb6-20" data-line-number="20">crops_mean<span class="op">$</span>perc &lt;-<span class="st"> </span>crops_mean<span class="op">$</span>mean<span class="op">/</span><span class="kw">sum</span>(isimip_area<span class="op">$</span>area)<span class="op">*</span><span class="dv">100</span></a>
<a class="sourceLine" id="cb6-21" data-line-number="21"></a>
<a class="sourceLine" id="cb6-22" data-line-number="22"><span class="kw">library</span>(ggplot2)</a>
<a class="sourceLine" id="cb6-23" data-line-number="23"><span class="kw">colnames</span>(crops_mean) &lt;-<span class="st"> </span><span class="kw">c</span>(<span class="st">&quot;time_rcp&quot;</span>, <span class="st">&quot;var&quot;</span>, <span class="st">&quot;scenario&quot;</span>, <span class="st">&quot;area&quot;</span>, <span class="st">&quot;perc&quot;</span>)</a>
<a class="sourceLine" id="cb6-24" data-line-number="24">crops_mean<span class="op">$</span>var &lt;-<span class="st"> </span><span class="kw">factor</span>(crops_mean<span class="op">$</span>var)</a>
<a class="sourceLine" id="cb6-25" data-line-number="25"><span class="kw">ggplot</span>(<span class="dt">data=</span>crops_mean, <span class="kw">aes</span>(<span class="dt">x=</span>time_rcp, <span class="dt">y=</span>area<span class="op">/</span><span class="dv">1000000</span>, <span class="dt">fill=</span>var)) <span class="op">+</span><span class="st"> </span></a>
<a class="sourceLine" id="cb6-26" data-line-number="26"><span class="st">  </span><span class="kw">geom_bar</span>(<span class="dt">stat=</span><span class="st">&quot;identity&quot;</span>, <span class="dt">position=</span><span class="st">&quot;stack&quot;</span>) <span class="op">+</span><span class="st"> </span><span class="kw">facet_wrap</span>(<span class="op">~</span>scenario, <span class="dt">ncol=</span><span class="dv">1</span>) <span class="op">+</span><span class="st"> </span></a>
<a class="sourceLine" id="cb6-27" data-line-number="27"><span class="st">  </span><span class="co">#geom_text(aes(label=round(perc, digits=2))) +</span></a>
<a class="sourceLine" id="cb6-28" data-line-number="28"><span class="st">  </span><span class="kw">scale_fill_discrete</span>(<span class="dt">name=</span><span class="st">&quot;Land-use type&quot;</span>) <span class="op">+</span><span class="st"> </span></a>
<a class="sourceLine" id="cb6-29" data-line-number="29"><span class="st">  </span><span class="co">#scale_x_discrete(name=&quot;&quot;, labels=c(&quot;1995&quot;, &quot;2050 \n RCP2.6&quot;, &quot;2050 \n RCP6.0&quot;, &quot;2080 \n RCP2.6&quot;, &quot;2080 \n RCP6.0&quot;)) + </span></a>
<a class="sourceLine" id="cb6-30" data-line-number="30"><span class="st">  </span><span class="kw">scale_y_continuous</span>(<span class="dt">name=</span><span class="st">&quot;Area (kmÂ² x 1,000,000)&quot;</span>, <span class="dt">limits=</span><span class="kw">c</span>(<span class="dv">0</span>,<span class="dv">150</span>), <span class="dt">expand=</span><span class="kw">c</span>(<span class="dv">0</span>,<span class="dv">0</span>)) <span class="op">+</span><span class="st"> </span></a>
<a class="sourceLine" id="cb6-31" data-line-number="31"><span class="st">  </span><span class="kw">theme_bw</span>() <span class="op">+</span><span class="st"> </span></a>
<a class="sourceLine" id="cb6-32" data-line-number="32"><span class="st">  </span><span class="kw">theme</span>(<span class="dt">legend.title=</span><span class="kw">element_text</span>(<span class="dt">face=</span><span class="st">&quot;bold&quot;</span>),</a>
<a class="sourceLine" id="cb6-33" data-line-number="33">        <span class="dt">axis.title.y=</span><span class="kw">element_text</span>(<span class="dt">face=</span><span class="st">&quot;bold&quot;</span>),</a>
<a class="sourceLine" id="cb6-34" data-line-number="34">        <span class="dt">rect =</span> <span class="kw">element_rect</span>(<span class="dt">fill =</span> <span class="st">&quot;transparent&quot;</span>, <span class="dt">colour=</span><span class="ot">NA</span>))</a></code></pre></div>
<p>Dominant land-use type</p>
<div class="sourceCode" id="cb7"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb7-1" data-line-number="1"><span class="co"># Calculate dominant landuse per grid cell</span></a>
<a class="sourceLine" id="cb7-2" data-line-number="2">dominant_lu &lt;-<span class="st"> </span>crops <span class="op">%&gt;%</span><span class="st"> </span><span class="kw">filter</span>(year <span class="op">!=</span><span class="st"> </span><span class="dv">1995</span> <span class="op">|</span><span class="st"> </span>scenario <span class="op">!=</span><span class="st"> &quot;rcp60&quot;</span>) <span class="op">%&gt;%</span></a>
<a class="sourceLine" id="cb7-3" data-line-number="3"><span class="st">  </span><span class="kw">select</span>(<span class="op">-</span><span class="kw">c</span>(area, <span class="kw">matches</span>(<span class="st">&quot;total&quot;</span>))) <span class="op">%&gt;%</span><span class="st"> </span></a>
<a class="sourceLine" id="cb7-4" data-line-number="4"><span class="st">  </span>tidyr<span class="op">::</span><span class="kw">gather</span>(var, value, <span class="op">-</span><span class="kw">c</span>(x,y,year,scenario, model)) <span class="op">%&gt;%</span><span class="st"> </span></a>
<a class="sourceLine" id="cb7-5" data-line-number="5"><span class="st">  </span><span class="kw">group_by</span>(x,y,year,scenario, model) <span class="op">%&gt;%</span><span class="st"> </span></a>
<a class="sourceLine" id="cb7-6" data-line-number="6"><span class="st">  </span><span class="kw">summarise</span>(<span class="dt">lu=</span><span class="kw">which.max</span>(value)) <span class="op">%&gt;%</span><span class="st"> </span></a>
<a class="sourceLine" id="cb7-7" data-line-number="7"><span class="st">  </span><span class="kw">as.data.frame</span>()</a>
<a class="sourceLine" id="cb7-8" data-line-number="8"></a>
<a class="sourceLine" id="cb7-9" data-line-number="9">labels_lu &lt;-<span class="st"> </span><span class="kw">colnames</span>(crops)[<span class="op">!</span><span class="kw">colnames</span>(crops) <span class="op">%in%</span><span class="st"> </span><span class="kw">c</span>(<span class="st">&quot;x&quot;</span>,<span class="st">&quot;y&quot;</span>,<span class="st">&quot;year&quot;</span>,<span class="st">&quot;scenario&quot;</span>,<span class="st">&quot;model&quot;</span>, <span class="st">&quot;area&quot;</span>)]</a>
<a class="sourceLine" id="cb7-10" data-line-number="10">labels_lu &lt;-<span class="st"> </span>labels_lu[<span class="kw">unique</span>(dominant_lu<span class="op">$</span>lu)]</a>
<a class="sourceLine" id="cb7-11" data-line-number="11">dominant_lu<span class="op">$</span>lu &lt;-<span class="st"> </span><span class="kw">factor</span>(dominant_lu<span class="op">$</span>lu, <span class="dt">labels=</span>labels_lu)</a>
<a class="sourceLine" id="cb7-12" data-line-number="12"></a>
<a class="sourceLine" id="cb7-13" data-line-number="13">dominant_lu &lt;-<span class="st"> </span>dominant_lu <span class="op">%&gt;%</span><span class="st"> </span><span class="kw">filter</span>(year <span class="op">%in%</span><span class="st"> </span><span class="kw">c</span>(<span class="st">&quot;1995&quot;</span>, <span class="st">&quot;2080&quot;</span>)) <span class="op">%&gt;%</span><span class="st"> </span></a>
<a class="sourceLine" id="cb7-14" data-line-number="14"><span class="st">  </span><span class="kw">filter</span>(scenario <span class="op">%in%</span><span class="st"> </span><span class="kw">c</span>(<span class="st">&quot;rcp26&quot;</span>, <span class="st">&quot;rcp60&quot;</span>)) <span class="op">%&gt;%</span><span class="st"> </span></a>
<a class="sourceLine" id="cb7-15" data-line-number="15"><span class="st">  </span>tidyr<span class="op">::</span><span class="kw">unite</span>(time_rcp, year, scenario, <span class="dt">sep=</span><span class="st">&quot; &quot;</span>)</a>
<a class="sourceLine" id="cb7-16" data-line-number="16">dominant_lu<span class="op">$</span>time_rcp &lt;-<span class="st"> </span><span class="kw">factor</span>(dominant_lu<span class="op">$</span>time_rcp, </a>
<a class="sourceLine" id="cb7-17" data-line-number="17">                               <span class="dt">labels=</span><span class="kw">c</span>(<span class="st">&quot;1995&quot;</span>, <span class="st">&quot;2080 RCP2.6&quot;</span>, <span class="st">&quot;2080 RCP6.0&quot;</span>))</a>
<a class="sourceLine" id="cb7-18" data-line-number="18"><span class="co"># Create Map</span></a>
<a class="sourceLine" id="cb7-19" data-line-number="19"><span class="kw">data</span>(outline, <span class="dt">package=</span><span class="st">&quot;ggmap2&quot;</span>)</a>
<a class="sourceLine" id="cb7-20" data-line-number="20"><span class="kw">ggplot</span>() <span class="op">+</span><span class="st"> </span></a>
<a class="sourceLine" id="cb7-21" data-line-number="21"><span class="st">  </span><span class="kw">geom_tile</span>(<span class="dt">data=</span>dominant_lu, <span class="kw">aes</span>(<span class="dt">x=</span>x, <span class="dt">y=</span>y, <span class="dt">fill=</span><span class="kw">factor</span>(lu))) <span class="op">+</span><span class="st"> </span></a>
<a class="sourceLine" id="cb7-22" data-line-number="22"><span class="st">  </span><span class="kw">facet_grid</span>(model <span class="op">~</span><span class="st"> </span>time_rcp) <span class="op">+</span><span class="st"> </span></a>
<a class="sourceLine" id="cb7-23" data-line-number="23"><span class="st">  </span><span class="kw">geom_polygon</span>(<span class="dt">data=</span>outline, <span class="kw">aes</span>(<span class="dt">x=</span>long,<span class="dt">y=</span>lat, <span class="dt">group=</span>group), </a>
<a class="sourceLine" id="cb7-24" data-line-number="24">               <span class="dt">fill=</span><span class="st">&quot;transparent&quot;</span>, <span class="dt">colour=</span><span class="st">&quot;black&quot;</span>) <span class="op">+</span><span class="st"> </span></a>
<a class="sourceLine" id="cb7-25" data-line-number="25"><span class="st">  </span><span class="kw">scale_fill_discrete</span>(<span class="dt">name=</span><span class="st">&quot;Dominant landuse type&quot;</span>, <span class="dt">labels=</span>labels_lu) <span class="op">+</span><span class="st"> </span></a>
<a class="sourceLine" id="cb7-26" data-line-number="26"><span class="st">  </span><span class="kw">theme_bw</span>() <span class="op">+</span><span class="st"> </span><span class="kw">theme</span>(<span class="dt">strip.background=</span> <span class="kw">element_blank</span>()) <span class="op">+</span><span class="st"> </span></a>
<a class="sourceLine" id="cb7-27" data-line-number="27"><span class="st">  </span><span class="kw">scale_x_continuous</span>(<span class="dt">name=</span><span class="kw">expression</span>(<span class="kw">paste</span>(<span class="st">&quot;Longitude (&quot;</span>,degree,<span class="st">&quot;)&quot;</span>)), <span class="dt">expand=</span><span class="kw">c</span>(<span class="fl">0.01</span>,<span class="fl">0.01</span>),</a>
<a class="sourceLine" id="cb7-28" data-line-number="28">                     <span class="dt">breaks=</span><span class="kw">c</span>(<span class="op">-</span><span class="dv">120</span>, <span class="dv">-60</span>, <span class="dv">0</span>, <span class="dv">60</span>, <span class="dv">120</span>, <span class="dv">180</span>)) <span class="op">+</span><span class="st"> </span></a>
<a class="sourceLine" id="cb7-29" data-line-number="29"><span class="st">  </span><span class="kw">scale_y_continuous</span>(<span class="dt">name=</span><span class="kw">expression</span>(<span class="kw">paste</span>(<span class="st">&quot;Latitude (&quot;</span>,degree,<span class="st">&quot;)&quot;</span>)), <span class="dt">expand=</span><span class="kw">c</span>(<span class="fl">0.01</span>,<span class="fl">0.01</span>),</a>
<a class="sourceLine" id="cb7-30" data-line-number="30">                     <span class="dt">breaks=</span><span class="kw">c</span>(<span class="op">-</span><span class="dv">60</span>, <span class="dv">-40</span>, <span class="dv">-20</span>, <span class="dv">0</span>, <span class="dv">20</span>, <span class="dv">40</span>, <span class="dv">60</span>,<span class="dv">80</span>)) <span class="op">+</span><span class="st"> </span></a>
<a class="sourceLine" id="cb7-31" data-line-number="31"><span class="st">  </span><span class="kw">coord_quickmap</span>(<span class="dt">xlim=</span><span class="kw">c</span>(<span class="op">-</span><span class="dv">180</span>,<span class="dv">180</span>), <span class="dt">ylim=</span><span class="kw">c</span>(<span class="op">-</span><span class="dv">60</span>,<span class="dv">80</span>))</a></code></pre></div>
<p>Land-use coverage</p>
<div class="sourceCode" id="cb8"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb8-1" data-line-number="1"><span class="co">#Calculate mean across GCMs</span></a>
<a class="sourceLine" id="cb8-2" data-line-number="2">landuse &lt;-<span class="st"> </span>crops <span class="op">%&gt;%</span><span class="st"> </span><span class="kw">select</span>(<span class="op">-</span><span class="kw">c</span>(area, cropland_total)) <span class="op">%&gt;%</span><span class="st"> </span></a>
<a class="sourceLine" id="cb8-3" data-line-number="3"><span class="st">  </span>tidyr<span class="op">::</span><span class="kw">gather</span>(var, value, <span class="op">-</span><span class="kw">c</span>(x,y,year,scenario,model)) <span class="op">%&gt;%</span><span class="st"> </span></a>
<a class="sourceLine" id="cb8-4" data-line-number="4"><span class="st">  </span><span class="kw">group_by</span>(x,y,year,scenario, var) <span class="op">%&gt;%</span><span class="st"> </span><span class="kw">summarise</span>(<span class="dt">value=</span><span class="kw">mean</span>(value,<span class="dt">na.rm=</span>T))</a>
<a class="sourceLine" id="cb8-5" data-line-number="5">landuse<span class="op">$</span>var &lt;-<span class="st"> </span><span class="kw">factor</span>(landuse<span class="op">$</span>var)</a>
<a class="sourceLine" id="cb8-6" data-line-number="6"></a>
<a class="sourceLine" id="cb8-7" data-line-number="7"><span class="co"># Specify colour ramp</span></a>
<a class="sourceLine" id="cb8-8" data-line-number="8">colourtheme &lt;-<span class="st"> </span><span class="kw">colorRampPalette</span>(<span class="kw">c</span>(<span class="st">&quot;white&quot;</span>, <span class="st">&quot;#00007F&quot;</span>, <span class="st">&quot;blue&quot;</span>, <span class="st">&quot;#007FFF&quot;</span>, <span class="st">&quot;cyan&quot;</span>, </a>
<a class="sourceLine" id="cb8-9" data-line-number="9">                                  <span class="st">&quot;#7FFF7F&quot;</span>, <span class="st">&quot;yellow&quot;</span>, <span class="st">&quot;#FF7F00&quot;</span>, <span class="st">&quot;red&quot;</span>, </a>
<a class="sourceLine" id="cb8-10" data-line-number="10">                                  <span class="st">&quot;#7F0000&quot;</span>))(<span class="dv">255</span>)</a>
<a class="sourceLine" id="cb8-11" data-line-number="11"></a>
<a class="sourceLine" id="cb8-12" data-line-number="12"><span class="co"># Create Map of 1995</span></a>
<a class="sourceLine" id="cb8-13" data-line-number="13">landuse_<span class="dv">1995</span> &lt;-<span class="st"> </span>landuse[landuse<span class="op">$</span>year <span class="op">==</span><span class="st"> </span><span class="dv">1995</span> <span class="op">&amp;</span><span class="st"> </span>landuse<span class="op">$</span>scenario <span class="op">==</span><span class="st"> &quot;rcp26&quot;</span>,]</a>
<a class="sourceLine" id="cb8-14" data-line-number="14">landuse_<span class="dv">1995</span> &lt;-<span class="st"> </span>landuse_<span class="dv">1995</span>[landuse_<span class="dv">1995</span><span class="op">$</span>var <span class="op">%in%</span><span class="st"> </span><span class="kw">c</span>(<span class="st">&quot;cropland_irrigated&quot;</span>, <span class="st">&quot;cropland_rainfed&quot;</span>, <span class="st">&quot;pastures&quot;</span>),]</a>
<a class="sourceLine" id="cb8-15" data-line-number="15"><span class="kw">ggplot</span>() <span class="op">+</span><span class="st"> </span><span class="kw">geom_tile</span>(<span class="dt">data=</span>landuse_<span class="dv">1995</span>, <span class="kw">aes</span>(<span class="dt">x=</span>x, <span class="dt">y=</span>y, <span class="dt">fill=</span>value<span class="op">*</span><span class="dv">100</span>)) <span class="op">+</span><span class="st"> </span><span class="kw">facet_wrap</span>(var <span class="op">~</span><span class="st"> </span>., <span class="dt">ncol=</span><span class="dv">1</span>) <span class="op">+</span><span class="st"> </span></a>
<a class="sourceLine" id="cb8-16" data-line-number="16"><span class="st">  </span><span class="kw">geom_polygon</span>(<span class="dt">data=</span>outline, <span class="kw">aes</span>(<span class="dt">x=</span>long,<span class="dt">y=</span>lat, <span class="dt">group=</span>group), </a>
<a class="sourceLine" id="cb8-17" data-line-number="17">               <span class="dt">fill=</span><span class="st">&quot;transparent&quot;</span>, <span class="dt">colour=</span><span class="st">&quot;black&quot;</span>) <span class="op">+</span><span class="st"> </span></a>
<a class="sourceLine" id="cb8-18" data-line-number="18"><span class="st">  </span><span class="kw">scale_fill_gradientn</span>(<span class="dt">name=</span><span class="st">&quot;% Cover&quot;</span>, <span class="dt">colours=</span>colourtheme, <span class="dt">na.value=</span><span class="st">&quot;transparent&quot;</span>, <span class="dt">limits=</span><span class="kw">c</span>(<span class="dv">0</span>,<span class="dv">100</span>)) <span class="op">+</span><span class="st"> </span></a>
<a class="sourceLine" id="cb8-19" data-line-number="19"><span class="st">  </span><span class="kw">theme_bw</span>() <span class="op">+</span><span class="st"> </span><span class="kw">theme</span>(<span class="dt">strip.background=</span> <span class="kw">element_blank</span>()) <span class="op">+</span><span class="st"> </span></a>
<a class="sourceLine" id="cb8-20" data-line-number="20"><span class="st">  </span><span class="kw">scale_x_continuous</span>(<span class="dt">name=</span><span class="kw">expression</span>(<span class="kw">paste</span>(<span class="st">&quot;Longitude (&quot;</span>,degree,<span class="st">&quot;)&quot;</span>)), <span class="dt">expand=</span><span class="kw">c</span>(<span class="fl">0.05</span>,<span class="fl">0.05</span>),</a>
<a class="sourceLine" id="cb8-21" data-line-number="21">                     <span class="dt">breaks=</span><span class="kw">c</span>(<span class="op">-</span><span class="dv">180</span>, <span class="dv">-90</span>, <span class="dv">0</span>, <span class="dv">90</span>, <span class="dv">180</span>)) <span class="op">+</span><span class="st"> </span></a>
<a class="sourceLine" id="cb8-22" data-line-number="22"><span class="st">  </span><span class="kw">scale_y_continuous</span>(<span class="dt">name=</span><span class="kw">expression</span>(<span class="kw">paste</span>(<span class="st">&quot;Latitude (&quot;</span>,degree,<span class="st">&quot;)&quot;</span>)), <span class="dt">expand=</span><span class="kw">c</span>(<span class="fl">0.05</span>,<span class="fl">0.05</span>),</a>
<a class="sourceLine" id="cb8-23" data-line-number="23">                     <span class="dt">breaks=</span><span class="kw">c</span>(<span class="op">-</span><span class="dv">60</span>, <span class="dv">-40</span>, <span class="dv">-20</span>, <span class="dv">0</span>, <span class="dv">20</span>, <span class="dv">40</span>, <span class="dv">60</span>, <span class="dv">80</span>)) <span class="op">+</span><span class="st"> </span></a>
<a class="sourceLine" id="cb8-24" data-line-number="24"><span class="st">  </span><span class="kw">coord_cartesian</span>(<span class="dt">xlim=</span><span class="kw">c</span>(<span class="op">-</span><span class="dv">180</span>,<span class="dv">180</span>), <span class="dt">ylim=</span><span class="kw">c</span>(<span class="op">-</span><span class="dv">60</span>,<span class="dv">84</span>))</a>
<a class="sourceLine" id="cb8-25" data-line-number="25"></a>
<a class="sourceLine" id="cb8-26" data-line-number="26"><span class="co">#Plot map for individual future years</span></a>
<a class="sourceLine" id="cb8-27" data-line-number="27"><span class="kw">data</span>(<span class="st">&quot;outline&quot;</span>, <span class="dt">package=</span><span class="st">&quot;ggmap2&quot;</span>)</a>
<a class="sourceLine" id="cb8-28" data-line-number="28">landuse_rcp26 &lt;-<span class="st"> </span>landuse[landuse<span class="op">$</span>year <span class="op">==</span><span class="st"> </span><span class="dv">2080</span> <span class="op">&amp;</span><span class="st"> </span>landuse<span class="op">$</span>scenario <span class="op">==</span><span class="st"> &quot;rcp26&quot;</span>,]</a>
<a class="sourceLine" id="cb8-29" data-line-number="29"><span class="kw">ggplot</span>() <span class="op">+</span><span class="st"> </span><span class="kw">geom_tile</span>(<span class="dt">data=</span>landuse_rcp26, <span class="kw">aes</span>(<span class="dt">x=</span>x, <span class="dt">y=</span>y, <span class="dt">fill=</span>value<span class="op">*</span><span class="dv">100</span>)) <span class="op">+</span><span class="st"> </span><span class="kw">facet_wrap</span>(. <span class="op">~</span><span class="st"> </span>var) <span class="op">+</span><span class="st"> </span></a>
<a class="sourceLine" id="cb8-30" data-line-number="30"><span class="st">  </span><span class="kw">geom_polygon</span>(<span class="dt">data=</span>outline, <span class="kw">aes</span>(<span class="dt">x=</span>long,<span class="dt">y=</span>lat, <span class="dt">group=</span>group), <span class="dt">fill=</span><span class="st">&quot;transparent&quot;</span>, <span class="dt">colour=</span><span class="st">&quot;black&quot;</span>) <span class="op">+</span><span class="st"> </span></a>
<a class="sourceLine" id="cb8-31" data-line-number="31"><span class="st">  </span><span class="kw">scale_fill_gradientn</span>(<span class="dt">name=</span><span class="st">&quot;% Cover&quot;</span>, <span class="dt">colours=</span>colourtheme, <span class="dt">na.value=</span><span class="st">&quot;transparent&quot;</span>, <span class="dt">limits=</span><span class="kw">c</span>(<span class="dv">0</span>,<span class="dv">100</span>)) <span class="op">+</span><span class="st"> </span></a>
<a class="sourceLine" id="cb8-32" data-line-number="32"><span class="st">  </span><span class="kw">theme_bw</span>() <span class="op">+</span><span class="st"> </span><span class="kw">theme</span>(<span class="dt">strip.background=</span> <span class="kw">element_blank</span>()) <span class="op">+</span><span class="st"> </span></a>
<a class="sourceLine" id="cb8-33" data-line-number="33"><span class="st">  </span><span class="kw">scale_x_continuous</span>(<span class="dt">name=</span><span class="kw">expression</span>(<span class="kw">paste</span>(<span class="st">&quot;Longitude (&quot;</span>,degree,<span class="st">&quot;)&quot;</span>)), </a>
<a class="sourceLine" id="cb8-34" data-line-number="34">                     <span class="dt">expand=</span><span class="kw">c</span>(<span class="fl">0.05</span>,<span class="fl">0.05</span>), <span class="dt">breaks=</span><span class="kw">c</span>(<span class="op">-</span><span class="dv">180</span>, <span class="dv">-90</span>, <span class="dv">0</span>, <span class="dv">90</span>, <span class="dv">180</span>)) <span class="op">+</span><span class="st"> </span></a>
<a class="sourceLine" id="cb8-35" data-line-number="35"><span class="st">  </span><span class="kw">scale_y_continuous</span>(<span class="dt">name=</span><span class="kw">expression</span>(<span class="kw">paste</span>(<span class="st">&quot;Latitude (&quot;</span>,degree,<span class="st">&quot;)&quot;</span>)), </a>
<a class="sourceLine" id="cb8-36" data-line-number="36">                     <span class="dt">expand=</span><span class="kw">c</span>(<span class="fl">0.05</span>,<span class="fl">0.05</span>), <span class="dt">breaks=</span><span class="kw">c</span>(<span class="op">-</span><span class="dv">60</span>, <span class="dv">-40</span>, <span class="dv">-20</span>, <span class="dv">0</span>, <span class="dv">20</span>, <span class="dv">40</span>, <span class="dv">60</span>,<span class="dv">80</span>)) <span class="op">+</span><span class="st"> </span></a>
<a class="sourceLine" id="cb8-37" data-line-number="37"><span class="st">  </span><span class="kw">coord_cartesian</span>(<span class="dt">xlim=</span><span class="kw">c</span>(<span class="op">-</span><span class="dv">180</span>,<span class="dv">180</span>), <span class="dt">ylim=</span><span class="kw">c</span>(<span class="op">-</span><span class="dv">60</span>,<span class="dv">84</span>))</a>
<a class="sourceLine" id="cb8-38" data-line-number="38"></a>
<a class="sourceLine" id="cb8-39" data-line-number="39">landuse_rcp60 &lt;-<span class="st"> </span>landuse[landuse<span class="op">$</span>year <span class="op">==</span><span class="st"> </span><span class="dv">2080</span> <span class="op">&amp;</span><span class="st"> </span>landuse<span class="op">$</span>scenario <span class="op">==</span><span class="st"> &quot;rcp60&quot;</span>,]</a>
<a class="sourceLine" id="cb8-40" data-line-number="40"><span class="kw">ggplot</span>() <span class="op">+</span><span class="st"> </span><span class="kw">geom_tile</span>(<span class="dt">data=</span>landuse_rcp60, <span class="kw">aes</span>(<span class="dt">x=</span>x, <span class="dt">y=</span>y, <span class="dt">fill=</span>value<span class="op">*</span><span class="dv">100</span>)) <span class="op">+</span><span class="st"> </span><span class="kw">facet_wrap</span>(. <span class="op">~</span><span class="st"> </span>var) <span class="op">+</span><span class="st"> </span></a>
<a class="sourceLine" id="cb8-41" data-line-number="41"><span class="st">  </span><span class="kw">geom_polygon</span>(<span class="dt">data=</span>outline, <span class="kw">aes</span>(<span class="dt">x=</span>long,<span class="dt">y=</span>lat, <span class="dt">group=</span>group), <span class="dt">fill=</span><span class="st">&quot;transparent&quot;</span>, <span class="dt">colour=</span><span class="st">&quot;black&quot;</span>) <span class="op">+</span><span class="st"> </span></a>
<a class="sourceLine" id="cb8-42" data-line-number="42"><span class="st">  </span><span class="kw">scale_fill_gradientn</span>(<span class="dt">name=</span><span class="st">&quot;% Cover&quot;</span>, <span class="dt">colours=</span>colourtheme, <span class="dt">na.value=</span><span class="st">&quot;transparent&quot;</span>, <span class="dt">limits=</span><span class="kw">c</span>(<span class="dv">0</span>,<span class="dv">100</span>)) <span class="op">+</span><span class="st"> </span></a>
<a class="sourceLine" id="cb8-43" data-line-number="43"><span class="st">  </span><span class="kw">theme_bw</span>() <span class="op">+</span><span class="st"> </span><span class="kw">theme</span>(<span class="dt">strip.background=</span> <span class="kw">element_blank</span>()) <span class="op">+</span><span class="st"> </span></a>
<a class="sourceLine" id="cb8-44" data-line-number="44"><span class="st">  </span><span class="kw">scale_x_continuous</span>(<span class="dt">name=</span><span class="kw">expression</span>(<span class="kw">paste</span>(<span class="st">&quot;Longitude (&quot;</span>,degree,<span class="st">&quot;)&quot;</span>)), </a>
<a class="sourceLine" id="cb8-45" data-line-number="45">                     <span class="dt">expand=</span><span class="kw">c</span>(<span class="fl">0.05</span>,<span class="fl">0.05</span>), <span class="dt">breaks=</span><span class="kw">c</span>(<span class="op">-</span><span class="dv">180</span>, <span class="dv">-90</span>, <span class="dv">0</span>, <span class="dv">90</span>, <span class="dv">180</span>)) <span class="op">+</span><span class="st"> </span></a>
<a class="sourceLine" id="cb8-46" data-line-number="46"><span class="st">  </span><span class="kw">scale_y_continuous</span>(<span class="dt">name=</span><span class="kw">expression</span>(<span class="kw">paste</span>(<span class="st">&quot;Latitude (&quot;</span>,degree,<span class="st">&quot;)&quot;</span>)), </a>
<a class="sourceLine" id="cb8-47" data-line-number="47">                     <span class="dt">expand=</span><span class="kw">c</span>(<span class="fl">0.05</span>,<span class="fl">0.05</span>), <span class="dt">breaks=</span><span class="kw">c</span>(<span class="op">-</span><span class="dv">60</span>, <span class="dv">-40</span>, <span class="dv">-20</span>, <span class="dv">0</span>, <span class="dv">20</span>, <span class="dv">40</span>, <span class="dv">60</span>,<span class="dv">80</span>)) <span class="op">+</span><span class="st"> </span></a>
<a class="sourceLine" id="cb8-48" data-line-number="48"><span class="st">  </span><span class="kw">coord_cartesian</span>(<span class="dt">xlim=</span><span class="kw">c</span>(<span class="op">-</span><span class="dv">180</span>,<span class="dv">180</span>), <span class="dt">ylim=</span><span class="kw">c</span>(<span class="op">-</span><span class="dv">60</span>,<span class="dv">84</span>))</a></code></pre></div>
<p>Land-use change</p>
<div class="sourceCode" id="cb9"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb9-1" data-line-number="1"><span class="co"># Change land-use categories</span></a>
<a class="sourceLine" id="cb9-2" data-line-number="2">landuse_all &lt;-<span class="st"> </span>crops <span class="op">%&gt;%</span><span class="st"> </span>dplyr<span class="op">::</span><span class="kw">select</span>(<span class="op">-</span><span class="kw">c</span>(area, <span class="kw">matches</span>(<span class="st">&quot;total&quot;</span>))) </a>
<a class="sourceLine" id="cb9-3" data-line-number="3">landuse_all<span class="op">$</span>biofuel_cropland &lt;-<span class="st"> </span>landuse_all<span class="op">$</span>biofuel_cropland_irrigated <span class="op">+</span><span class="st"> </span>landuse_all<span class="op">$</span>biofuel_cropland_rainfed</a>
<a class="sourceLine" id="cb9-4" data-line-number="4">landuse_all<span class="op">$</span>biofuel_cropland[<span class="kw">is.na</span>(landuse_all<span class="op">$</span>biofuel_cropland)] &lt;-<span class="st"> </span><span class="dv">0</span></a>
<a class="sourceLine" id="cb9-5" data-line-number="5">landuse_all<span class="op">$</span>cropland &lt;-<span class="st"> </span>landuse_all<span class="op">$</span>cropland_rainfed <span class="op">+</span><span class="st"> </span>landuse_all<span class="op">$</span>cropland_irrigated</a>
<a class="sourceLine" id="cb9-6" data-line-number="6"></a>
<a class="sourceLine" id="cb9-7" data-line-number="7"><span class="co"># Change format of land-use data</span></a>
<a class="sourceLine" id="cb9-8" data-line-number="8">landuse_fut &lt;-<span class="st"> </span>landuse_all <span class="op">%&gt;%</span><span class="st"> </span><span class="kw">select</span>(<span class="op">-</span><span class="kw">c</span>(cropland_irrigated, cropland_rainfed,</a>
<a class="sourceLine" id="cb9-9" data-line-number="9">                                         biofuel_cropland_irrigated, </a>
<a class="sourceLine" id="cb9-10" data-line-number="10">                                         biofuel_cropland_rainfed)) <span class="op">%&gt;%</span><span class="st"> </span></a>
<a class="sourceLine" id="cb9-11" data-line-number="11"><span class="st">  </span>tidyr<span class="op">::</span><span class="kw">gather</span>(var, value, <span class="op">-</span><span class="kw">c</span>(x,y,year, scenario, model))</a>
<a class="sourceLine" id="cb9-12" data-line-number="12">landuse_fut &lt;-<span class="st"> </span>tidyr<span class="op">::</span><span class="kw">spread</span>(landuse_fut, year, value)</a>
<a class="sourceLine" id="cb9-13" data-line-number="13">landuse_fut &lt;-<span class="st"> </span>landuse_fut <span class="op">%&gt;%</span><span class="st"> </span>tidyr<span class="op">::</span><span class="kw">replace_na</span>(<span class="kw">list</span>(<span class="st">`</span><span class="dt">1995</span><span class="st">`</span>=<span class="dv">0</span>, <span class="st">`</span><span class="dt">2080</span><span class="st">`</span>=<span class="dv">0</span>))</a>
<a class="sourceLine" id="cb9-14" data-line-number="14"></a>
<a class="sourceLine" id="cb9-15" data-line-number="15"><span class="co"># Calculate delta landuse</span></a>
<a class="sourceLine" id="cb9-16" data-line-number="16">delta_landuse &lt;-<span class="st"> </span>landuse_fut <span class="op">%&gt;%</span><span class="st"> </span><span class="kw">group_by</span>(x,y,scenario,var) <span class="op">%&gt;%</span><span class="st"> </span></a>
<a class="sourceLine" id="cb9-17" data-line-number="17"><span class="st">  </span>dplyr<span class="op">::</span><span class="kw">summarise_at</span>(<span class="kw">vars</span>(<span class="st">`</span><span class="dt">1995</span><span class="st">`</span><span class="op">:</span><span class="st">`</span><span class="dt">2080</span><span class="st">`</span>), mean, <span class="dt">na.rm=</span><span class="ot">TRUE</span>)</a>
<a class="sourceLine" id="cb9-18" data-line-number="18">delta_landuse &lt;-<span class="st"> </span>delta_landuse <span class="op">%&gt;%</span><span class="st"> </span></a>
<a class="sourceLine" id="cb9-19" data-line-number="19"><span class="st">  </span><span class="kw">mutate_at</span>(<span class="kw">vars</span>(<span class="st">`</span><span class="dt">2080</span><span class="st">`</span>), <span class="kw">funs</span>(. <span class="op">-</span><span class="st"> `</span><span class="dt">1995</span><span class="st">`</span>))</a>
<a class="sourceLine" id="cb9-20" data-line-number="20">delta_landuse &lt;-<span class="st"> </span>tidyr<span class="op">::</span><span class="kw">gather</span>(delta_landuse, year, value, <span class="op">-</span><span class="kw">c</span>(x, y, scenario, var))</a>
<a class="sourceLine" id="cb9-21" data-line-number="21">delta_landuse<span class="op">$</span>year &lt;-<span class="st"> </span><span class="kw">as.numeric</span>(delta_landuse<span class="op">$</span>year)</a>
<a class="sourceLine" id="cb9-22" data-line-number="22"></a>
<a class="sourceLine" id="cb9-23" data-line-number="23"><span class="co">#Subset data for plotting</span></a>
<a class="sourceLine" id="cb9-24" data-line-number="24">landuse &lt;-<span class="st"> </span>delta_landuse[delta_landuse<span class="op">$</span>year <span class="op">==</span><span class="st"> </span><span class="dv">2080</span>,]</a>
<a class="sourceLine" id="cb9-25" data-line-number="25">landuse &lt;-<span class="st"> </span>landuse <span class="op">%&gt;%</span><span class="st"> </span>tidyr<span class="op">::</span><span class="kw">unite</span>(year, scenario, <span class="dt">col=</span><span class="st">&quot;time_rcp&quot;</span>)</a>
<a class="sourceLine" id="cb9-26" data-line-number="26">landuse<span class="op">$</span>time_rcp &lt;-<span class="st"> </span><span class="kw">factor</span>(landuse<span class="op">$</span>time_rcp, <span class="dt">labels=</span><span class="kw">c</span>(<span class="st">&quot;2080 RCP2.6&quot;</span>, <span class="st">&quot;2080 RCP6.0&quot;</span>))</a>
<a class="sourceLine" id="cb9-27" data-line-number="27">landuse<span class="op">$</span>var &lt;-<span class="st"> </span><span class="kw">factor</span>(landuse<span class="op">$</span>var, <span class="dt">labels=</span><span class="kw">c</span>(<span class="st">&quot;Biofuel cropland&quot;</span>, <span class="st">&quot;Cropland&quot;</span>, <span class="st">&quot;Other&quot;</span>, <span class="st">&quot;Pastures&quot;</span>))</a>
<a class="sourceLine" id="cb9-28" data-line-number="28"><span class="kw">ggplot</span>() <span class="op">+</span><span class="st"> </span></a>
<a class="sourceLine" id="cb9-29" data-line-number="29"><span class="st">  </span><span class="kw">geom_tile</span>(<span class="dt">data=</span>landuse, <span class="kw">aes</span>(<span class="dt">x=</span>x, <span class="dt">y=</span>y, <span class="dt">fill=</span>value<span class="op">*</span><span class="dv">100</span>)) <span class="op">+</span><span class="st"> </span></a>
<a class="sourceLine" id="cb9-30" data-line-number="30"><span class="st">  </span><span class="kw">facet_grid</span>(var <span class="op">~</span><span class="st"> </span>time_rcp, <span class="dt">scale=</span><span class="st">&quot;free_y&quot;</span>, <span class="dt">switch=</span><span class="st">&quot;y&quot;</span>) <span class="op">+</span><span class="st"> </span></a>
<a class="sourceLine" id="cb9-31" data-line-number="31"><span class="st">  </span><span class="kw">geom_polygon</span>(<span class="dt">data=</span>outline, <span class="kw">aes</span>(<span class="dt">x=</span>long,<span class="dt">y=</span>lat, <span class="dt">group=</span>group), </a>
<a class="sourceLine" id="cb9-32" data-line-number="32">               <span class="dt">fill=</span><span class="st">&quot;transparent&quot;</span>, <span class="dt">colour=</span><span class="st">&quot;black&quot;</span>) <span class="op">+</span><span class="st"> </span></a>
<a class="sourceLine" id="cb9-33" data-line-number="33"><span class="st">  </span><span class="kw">scale_fill_gradientn</span>(<span class="dt">name=</span><span class="st">&quot;%&quot;</span>, <span class="dt">colours=</span><span class="kw">rev</span>(<span class="kw">colorRampPalette</span>(</a>
<a class="sourceLine" id="cb9-34" data-line-number="34">    <span class="kw">c</span>(<span class="st">&quot;#00007F&quot;</span>, <span class="st">&quot;blue&quot;</span>, <span class="st">&quot;#007FFF&quot;</span>, <span class="st">&quot;cyan&quot;</span>, <span class="st">&quot;white&quot;</span>, <span class="st">&quot;yellow&quot;</span>, </a>
<a class="sourceLine" id="cb9-35" data-line-number="35">      <span class="st">&quot;#FF7F00&quot;</span>, <span class="st">&quot;red&quot;</span>, <span class="st">&quot;#7F0000&quot;</span>))(<span class="dv">255</span>)), <span class="dt">breaks=</span><span class="kw">c</span>(<span class="op">-</span><span class="dv">90</span>,<span class="op">-</span><span class="dv">60</span>,<span class="op">-</span><span class="dv">30</span>,<span class="dv">0</span>,<span class="dv">30</span>,<span class="dv">60</span>,<span class="dv">90</span>),</a>
<a class="sourceLine" id="cb9-36" data-line-number="36">    <span class="dt">values=</span><span class="kw">c</span>(<span class="dv">1</span>,<span class="fl">0.7</span>,<span class="fl">0.52</span>,<span class="fl">0.5</span>,<span class="fl">0.48</span>,<span class="fl">0.3</span>,<span class="dv">0</span>), <span class="dt">limits=</span><span class="kw">c</span>(<span class="op">-</span><span class="dv">90</span>,<span class="dv">90</span>), <span class="dt">na.value=</span><span class="st">&quot;transparent&quot;</span>) <span class="op">+</span></a>
<a class="sourceLine" id="cb9-37" data-line-number="37"><span class="st">  </span><span class="kw">theme_classic</span>() <span class="op">+</span><span class="st"> </span><span class="kw">theme</span>(<span class="dt">axis.title =</span> <span class="kw">element_blank</span>(),<span class="dt">axis.line =</span> <span class="kw">element_blank</span>(),</a>
<a class="sourceLine" id="cb9-38" data-line-number="38">                          <span class="dt">axis.ticks =</span> <span class="kw">element_blank</span>(), <span class="dt">axis.text =</span> <span class="kw">element_blank</span>(),</a>
<a class="sourceLine" id="cb9-39" data-line-number="39">                          <span class="dt">panel.grid =</span> <span class="kw">element_blank</span>(), <span class="dt">strip.background=</span> <span class="kw">element_blank</span>(),</a>
<a class="sourceLine" id="cb9-40" data-line-number="40">                          <span class="dt">strip.placement =</span> <span class="st">&quot;outside&quot;</span>, </a>
<a class="sourceLine" id="cb9-41" data-line-number="41">                          <span class="dt">strip.text =</span> <span class="kw">element_text</span>(<span class="dt">size=</span><span class="dv">10</span>, <span class="dt">face=</span><span class="st">&quot;bold&quot;</span>),</a>
<a class="sourceLine" id="cb9-42" data-line-number="42">                          <span class="dt">rect =</span> <span class="kw">element_rect</span>(<span class="dt">fill =</span> <span class="st">&quot;transparent&quot;</span>)) <span class="op">+</span><span class="st"> </span></a>
<a class="sourceLine" id="cb9-43" data-line-number="43"><span class="st">  </span><span class="kw">coord_quickmap</span>(<span class="dt">xlim=</span><span class="kw">c</span>(<span class="op">-</span><span class="dv">180</span>,<span class="dv">180</span>), <span class="dt">ylim=</span><span class="kw">c</span>(<span class="op">-</span><span class="dv">60</span>,<span class="dv">85</span>), <span class="dt">expand=</span><span class="ot">FALSE</span>)</a></code></pre></div>
<p>Land-use change in Europe</p>
<div class="sourceCode" id="cb10"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb10-1" data-line-number="1"><span class="co">#' getData from the raster package downloads automatically GADM data per country</span></a>
<a class="sourceLine" id="cb10-2" data-line-number="2">deu &lt;-<span class="st"> </span>raster<span class="op">::</span><span class="kw">getData</span>(<span class="dt">name=</span><span class="st">&quot;GADM&quot;</span>, <span class="dt">country=</span><span class="st">&quot;DEU&quot;</span>, <span class="dt">level=</span><span class="dv">1</span>, <span class="dt">path=</span><span class="kw">paste0</span>(filedir, <span class="st">&quot;/GADM&quot;</span>)) <span class="co"># Level1 gives regional boundaries</span></a>
<a class="sourceLine" id="cb10-3" data-line-number="3"><span class="co">#' Subset data by Bayern</span></a>
<a class="sourceLine" id="cb10-4" data-line-number="4">bavaria &lt;-<span class="st"> </span>deu[deu<span class="op">$</span>NAME_<span class="dv">1</span> <span class="op">==</span><span class="st"> &quot;Bayern&quot;</span>,]</a>
<a class="sourceLine" id="cb10-5" data-line-number="5"></a>
<a class="sourceLine" id="cb10-6" data-line-number="6"><span class="co">#Subset data for plotting</span></a>
<a class="sourceLine" id="cb10-7" data-line-number="7">landuse &lt;-<span class="st"> </span>delta_landuse[delta_landuse<span class="op">$</span>year <span class="op">==</span><span class="st"> </span><span class="dv">2080</span>,]</a>
<a class="sourceLine" id="cb10-8" data-line-number="8">landuse &lt;-<span class="st"> </span>landuse <span class="op">%&gt;%</span><span class="st"> </span>tidyr<span class="op">::</span><span class="kw">unite</span>(year, scenario, <span class="dt">col=</span><span class="st">&quot;time_rcp&quot;</span>)</a>
<a class="sourceLine" id="cb10-9" data-line-number="9">landuse<span class="op">$</span>time_rcp &lt;-<span class="st"> </span><span class="kw">factor</span>(landuse<span class="op">$</span>time_rcp, <span class="dt">labels=</span><span class="kw">c</span>(<span class="st">&quot;2080 RCP2.6&quot;</span>, <span class="st">&quot;2080 RCP6.0&quot;</span>))</a>
<a class="sourceLine" id="cb10-10" data-line-number="10">landuse<span class="op">$</span>var &lt;-<span class="st"> </span><span class="kw">factor</span>(landuse<span class="op">$</span>var, <span class="dt">labels=</span><span class="kw">c</span>(<span class="st">&quot;Biofuel cropland&quot;</span>, <span class="st">&quot;Cropland&quot;</span>, <span class="st">&quot;Other&quot;</span>, </a>
<a class="sourceLine" id="cb10-11" data-line-number="11">                                            <span class="st">&quot;Pastures&quot;</span>))</a>
<a class="sourceLine" id="cb10-12" data-line-number="12"><span class="kw">ggplot</span>() <span class="op">+</span><span class="st"> </span></a>
<a class="sourceLine" id="cb10-13" data-line-number="13"><span class="st">  </span><span class="kw">geom_tile</span>(<span class="dt">data=</span>landuse, <span class="kw">aes</span>(<span class="dt">x=</span>x, <span class="dt">y=</span>y, <span class="dt">fill=</span>value<span class="op">*</span><span class="dv">100</span>)) <span class="op">+</span><span class="st"> </span></a>
<a class="sourceLine" id="cb10-14" data-line-number="14"><span class="st">  </span><span class="kw">facet_grid</span>(var <span class="op">~</span><span class="st"> </span>time_rcp, <span class="dt">scale=</span><span class="st">&quot;free_y&quot;</span>, <span class="dt">switch=</span><span class="st">&quot;y&quot;</span>) <span class="op">+</span><span class="st"> </span></a>
<a class="sourceLine" id="cb10-15" data-line-number="15"><span class="st">  </span><span class="kw">geom_polygon</span>(<span class="dt">data=</span>outline, <span class="kw">aes</span>(<span class="dt">x=</span>long,<span class="dt">y=</span>lat, <span class="dt">group=</span>group), </a>
<a class="sourceLine" id="cb10-16" data-line-number="16">               <span class="dt">fill=</span><span class="st">&quot;transparent&quot;</span>, <span class="dt">colour=</span><span class="st">&quot;black&quot;</span>) <span class="op">+</span><span class="st"> </span></a>
<a class="sourceLine" id="cb10-17" data-line-number="17"><span class="st">  </span><span class="kw">geom_polygon</span>(<span class="dt">data=</span>bavaria, <span class="kw">aes</span>(<span class="dt">x=</span>long, <span class="dt">y=</span>lat, <span class="dt">group=</span>group),</a>
<a class="sourceLine" id="cb10-18" data-line-number="18">               <span class="dt">fill=</span><span class="st">&quot;transparent&quot;</span>, <span class="dt">colour=</span><span class="st">&quot;black&quot;</span>, <span class="dt">lty=</span><span class="st">&quot;dashed&quot;</span>) <span class="op">+</span><span class="st"> </span></a>
<a class="sourceLine" id="cb10-19" data-line-number="19"><span class="st">  </span><span class="kw">scale_fill_gradientn</span>(<span class="dt">name=</span><span class="st">&quot;%&quot;</span>, <span class="dt">colours=</span><span class="kw">rev</span>(<span class="kw">colorRampPalette</span>(</a>
<a class="sourceLine" id="cb10-20" data-line-number="20">    <span class="kw">c</span>(<span class="st">&quot;#00007F&quot;</span>, <span class="st">&quot;blue&quot;</span>, <span class="st">&quot;#007FFF&quot;</span>, <span class="st">&quot;cyan&quot;</span>, <span class="st">&quot;white&quot;</span>, <span class="st">&quot;yellow&quot;</span>, </a>
<a class="sourceLine" id="cb10-21" data-line-number="21">      <span class="st">&quot;#FF7F00&quot;</span>, <span class="st">&quot;red&quot;</span>, <span class="st">&quot;#7F0000&quot;</span>))(<span class="dv">255</span>)), <span class="dt">breaks=</span><span class="kw">c</span>(<span class="op">-</span><span class="dv">100</span>,<span class="op">-</span><span class="dv">75</span>,<span class="op">-</span><span class="dv">50</span>,<span class="op">-</span><span class="dv">25</span>,<span class="dv">0</span>,<span class="dv">25</span>,<span class="dv">50</span>,<span class="dv">75</span>,<span class="dv">100</span>),</a>
<a class="sourceLine" id="cb10-22" data-line-number="22">    <span class="dt">values=</span><span class="kw">c</span>(<span class="dv">1</span>,<span class="fl">0.7</span>,<span class="fl">0.52</span>,<span class="fl">0.5</span>,<span class="fl">0.48</span>,<span class="fl">0.3</span>,<span class="dv">0</span>), <span class="dt">limits=</span><span class="kw">c</span>(<span class="op">-</span><span class="dv">100</span>,<span class="dv">100</span>), <span class="dt">na.value=</span><span class="st">&quot;transparent&quot;</span>) <span class="op">+</span></a>
<a class="sourceLine" id="cb10-23" data-line-number="23"><span class="st">  </span><span class="kw">theme_classic</span>() <span class="op">+</span><span class="st"> </span><span class="kw">theme</span>(<span class="dt">axis.title =</span> <span class="kw">element_blank</span>(),<span class="dt">axis.line =</span> <span class="kw">element_blank</span>(),</a>
<a class="sourceLine" id="cb10-24" data-line-number="24">                          <span class="dt">axis.ticks =</span> <span class="kw">element_blank</span>(), <span class="dt">axis.text =</span> <span class="kw">element_blank</span>(),</a>
<a class="sourceLine" id="cb10-25" data-line-number="25">                          <span class="dt">panel.grid =</span> <span class="kw">element_blank</span>(), <span class="dt">strip.background=</span> <span class="kw">element_blank</span>(),</a>
<a class="sourceLine" id="cb10-26" data-line-number="26">                          <span class="dt">strip.placement =</span> <span class="st">&quot;outside&quot;</span>, </a>
<a class="sourceLine" id="cb10-27" data-line-number="27">                          <span class="dt">strip.text =</span> <span class="kw">element_text</span>(<span class="dt">size=</span><span class="dv">10</span>, <span class="dt">face=</span><span class="st">&quot;bold&quot;</span>),</a>
<a class="sourceLine" id="cb10-28" data-line-number="28">                          <span class="dt">rect =</span> <span class="kw">element_rect</span>(<span class="dt">fill =</span> <span class="st">&quot;transparent&quot;</span>)) <span class="op">+</span><span class="st"> </span></a>
<a class="sourceLine" id="cb10-29" data-line-number="29"><span class="st">  </span><span class="kw">coord_quickmap</span>(<span class="dt">xlim=</span><span class="kw">c</span>(<span class="op">-</span><span class="fl">11.5</span>,<span class="fl">40.5</span>), <span class="dt">ylim=</span><span class="kw">c</span>(<span class="fl">35.5</span>,<span class="dv">70</span>), <span class="dt">expand=</span><span class="ot">FALSE</span>)</a></code></pre></div>
</div>
<div id="top25-land-use-change-within-both-rcps" class="section level2">
<h2>Top25 Land-use change within both RCPs</h2>
<div class="sourceCode" id="cb11"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb11-1" data-line-number="1"><span class="co"># Calculate threshold value</span></a>
<a class="sourceLine" id="cb11-2" data-line-number="2">(threshold &lt;-<span class="st"> </span>delta_landuse <span class="op">%&gt;%</span><span class="st"> </span><span class="kw">group_by</span>(var, year) <span class="op">%&gt;%</span><span class="st"> </span><span class="kw">filter</span>(value <span class="op">&gt;</span><span class="st"> </span><span class="dv">0</span>) <span class="op">%&gt;%</span><span class="st"> </span></a>
<a class="sourceLine" id="cb11-3" data-line-number="3"><span class="st">   </span><span class="kw">summarise</span>(<span class="dt">threshold =</span> <span class="kw">quantile</span>(value, <span class="dt">probs=</span><span class="fl">0.75</span>)))</a>
<a class="sourceLine" id="cb11-4" data-line-number="4"></a>
<a class="sourceLine" id="cb11-5" data-line-number="5"><span class="co"># Subset data by threshold</span></a>
<a class="sourceLine" id="cb11-6" data-line-number="6">top25_lu &lt;-<span class="st"> </span><span class="kw">left_join</span>(delta_landuse, threshold)</a>
<a class="sourceLine" id="cb11-7" data-line-number="7">top25_lu &lt;-<span class="st"> </span>top25_lu <span class="op">%&gt;%</span><span class="st"> </span><span class="kw">group_by</span>(x,y,scenario, var, year) <span class="op">%&gt;%</span><span class="st"> </span></a>
<a class="sourceLine" id="cb11-8" data-line-number="8"><span class="st">  </span><span class="kw">filter</span>(value <span class="op">&gt;</span><span class="st"> </span>threshold) <span class="op">%&gt;%</span><span class="st"> </span><span class="kw">select</span>(<span class="op">-</span>threshold)</a>
<a class="sourceLine" id="cb11-9" data-line-number="9">top25_lu<span class="op">$</span>value &lt;-<span class="st"> </span><span class="dv">1</span></a>
<a class="sourceLine" id="cb11-10" data-line-number="10"></a>
<a class="sourceLine" id="cb11-11" data-line-number="11"><span class="co"># Plot</span></a>
<a class="sourceLine" id="cb11-12" data-line-number="12">top25_lu <span class="op">%&gt;%</span><span class="st"> </span><span class="kw">filter</span>(year<span class="op">==</span><span class="dv">2080</span>) <span class="op">%&gt;%</span><span class="st"> </span></a>
<a class="sourceLine" id="cb11-13" data-line-number="13"><span class="st">  </span><span class="kw">ggplot</span>(<span class="kw">aes</span>(<span class="dt">x=</span>x,<span class="dt">y=</span>y)) <span class="op">+</span><span class="st"> </span><span class="kw">geom_tile</span>() <span class="op">+</span><span class="st"> </span></a>
<a class="sourceLine" id="cb11-14" data-line-number="14"><span class="st">  </span><span class="kw">geom_polygon</span>(<span class="dt">data=</span>outline, <span class="kw">aes</span>(<span class="dt">x=</span>long,<span class="dt">y=</span>lat, <span class="dt">group=</span>group), </a>
<a class="sourceLine" id="cb11-15" data-line-number="15">               <span class="dt">fill=</span><span class="st">&quot;transparent&quot;</span>, <span class="dt">colour=</span><span class="st">&quot;black&quot;</span>) <span class="op">+</span><span class="st"> </span></a>
<a class="sourceLine" id="cb11-16" data-line-number="16"><span class="st">  </span><span class="kw">facet_grid</span>(var<span class="op">~</span>scenario, <span class="dt">switch=</span><span class="st">&quot;y&quot;</span>) <span class="op">+</span><span class="st"> </span></a>
<a class="sourceLine" id="cb11-17" data-line-number="17"><span class="st">  </span><span class="kw">labs</span>(<span class="dt">x=</span><span class="st">&quot;&quot;</span>, <span class="dt">y=</span><span class="st">&quot;&quot;</span>) <span class="op">+</span><span class="st"> </span><span class="kw">theme_bw</span>() <span class="op">+</span><span class="st"> </span></a>
<a class="sourceLine" id="cb11-18" data-line-number="18"><span class="st">  </span><span class="kw">theme</span>(<span class="dt">strip.placement =</span> <span class="st">&quot;outside&quot;</span>, <span class="dt">strip.background =</span> <span class="kw">element_blank</span>())</a></code></pre></div>
<div id="land-use-time-series" class="section level3">
<h3>Land use Time series</h3>
<div class="sourceCode" id="cb12"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb12-1" data-line-number="1"><span class="co"># List data files </span></a>
<a class="sourceLine" id="cb12-2" data-line-number="2">data_total &lt;-<span class="st"> </span><span class="kw">list.files</span>(<span class="kw">paste0</span>(filedir, <span class="st">&quot;/ISIMIP2b/InputData/landuse&quot;</span>), </a>
<a class="sourceLine" id="cb12-3" data-line-number="3">                         <span class="dt">pattern=</span><span class="st">&quot;totals&quot;</span>, <span class="dt">recursive=</span>T, <span class="dt">full.names=</span>T)</a>
<a class="sourceLine" id="cb12-4" data-line-number="4">data_urban &lt;-<span class="st"> </span><span class="kw">list.files</span>(<span class="kw">paste0</span>(filedir, <span class="st">&quot;/ISIMIP2b/InputData/landuse&quot;</span>), </a>
<a class="sourceLine" id="cb12-5" data-line-number="5">                         <span class="dt">pattern=</span><span class="st">&quot;urbanareas&quot;</span>, <span class="dt">recursive=</span>T, <span class="dt">full.names=</span>T)</a>
<a class="sourceLine" id="cb12-6" data-line-number="6"></a>
<a class="sourceLine" id="cb12-7" data-line-number="7"><span class="co"># Re-create isimip area</span></a>
<a class="sourceLine" id="cb12-8" data-line-number="8"><span class="kw">data</span>(landseamask_generic, <span class="dt">package=</span><span class="st">&quot;rISIMIP&quot;</span>)</a>
<a class="sourceLine" id="cb12-9" data-line-number="9">isimip_area &lt;-<span class="st"> </span>raster<span class="op">::</span><span class="kw">area</span>(landseamask_generic, <span class="dt">na.rm=</span><span class="ot">TRUE</span>) <span class="co"># km2</span></a>
<a class="sourceLine" id="cb12-10" data-line-number="10"></a>
<a class="sourceLine" id="cb12-11" data-line-number="11"><span class="co"># Calculate total area of each land use class</span></a>
<a class="sourceLine" id="cb12-12" data-line-number="12">varnames &lt;-<span class="st"> </span><span class="kw">c</span>(<span class="st">&quot;cropland_total&quot;</span>, <span class="st">&quot;pastures&quot;</span>, <span class="st">&quot;cropland_irrigated&quot;</span>, <span class="st">&quot;cropland_rainfed&quot;</span>)</a>
<a class="sourceLine" id="cb12-13" data-line-number="13">data_crop_areas &lt;-<span class="st"> </span><span class="kw">lapply</span>(varnames, <span class="cf">function</span>(x){</a>
<a class="sourceLine" id="cb12-14" data-line-number="14">  data_total_area_sum &lt;-<span class="st"> </span><span class="kw">lapply</span>(data_total, <span class="cf">function</span>(y){</a>
<a class="sourceLine" id="cb12-15" data-line-number="15">    data &lt;-<span class="st"> </span>raster<span class="op">::</span><span class="kw">stack</span>(y, <span class="dt">varname=</span>x)</a>
<a class="sourceLine" id="cb12-16" data-line-number="16">    data_total_area &lt;-<span class="st"> </span>data<span class="op">*</span>isimip_area</a>
<a class="sourceLine" id="cb12-17" data-line-number="17">    data_total_area_sum &lt;-<span class="st"> </span><span class="kw">as.data.frame</span>(raster<span class="op">::</span><span class="kw">cellStats</span>(data_total_area, <span class="dt">stat=</span><span class="st">'sum'</span>, <span class="dt">na.rm=</span><span class="ot">TRUE</span>))</a>
<a class="sourceLine" id="cb12-18" data-line-number="18">    <span class="kw">colnames</span>(data_total_area_sum)[<span class="dv">1</span>]  &lt;-<span class="st"> &quot;area&quot;</span></a>
<a class="sourceLine" id="cb12-19" data-line-number="19">    nc &lt;-<span class="st"> </span>ncdf4<span class="op">::</span><span class="kw">nc_open</span>(y)</a>
<a class="sourceLine" id="cb12-20" data-line-number="20">    timeref &lt;-<span class="st"> </span>lubridate<span class="op">::</span><span class="kw">year</span>(<span class="kw">strsplit</span>(nc<span class="op">$</span>dim[[<span class="st">&quot;time&quot;</span>]]<span class="op">$</span>units, <span class="st">&quot; &quot;</span>)[[<span class="dv">1</span>]][<span class="dv">3</span>]) </a>
<a class="sourceLine" id="cb12-21" data-line-number="21">    <span class="cf">if</span>(ncdf4<span class="op">::</span><span class="kw">ncvar_get</span>(nc, nc<span class="op">$</span>dim<span class="op">$</span>time)[<span class="dv">1</span>] <span class="op">==</span><span class="st"> </span><span class="dv">0</span>){</a>
<a class="sourceLine" id="cb12-22" data-line-number="22">      data_total_area_sum<span class="op">$</span>year &lt;-<span class="st"> </span>timeref <span class="op">+</span><span class="st"> </span>ncdf4<span class="op">::</span><span class="kw">ncvar_get</span>(nc, nc<span class="op">$</span>dim<span class="op">$</span>time)</a>
<a class="sourceLine" id="cb12-23" data-line-number="23">    } <span class="cf">else</span> <span class="cf">if</span> (ncdf4<span class="op">::</span><span class="kw">ncvar_get</span>(nc, nc<span class="op">$</span>dim<span class="op">$</span>time)[<span class="dv">1</span>] <span class="op">!=</span><span class="st"> </span><span class="dv">0</span>){</a>
<a class="sourceLine" id="cb12-24" data-line-number="24">      data_total_area_sum<span class="op">$</span>year &lt;-<span class="st"> </span>timeref <span class="op">+</span><span class="st"> </span>ncdf4<span class="op">::</span><span class="kw">ncvar_get</span>(nc, nc<span class="op">$</span>dim<span class="op">$</span>time) <span class="op">-</span><span class="st"> </span><span class="dv">1</span></a>
<a class="sourceLine" id="cb12-25" data-line-number="25">    }</a>
<a class="sourceLine" id="cb12-26" data-line-number="26">    ncdf4<span class="op">::</span><span class="kw">nc_close</span>(nc)</a>
<a class="sourceLine" id="cb12-27" data-line-number="27">    data_total_area_sum<span class="op">$</span>scenario &lt;-<span class="st"> </span><span class="kw">strsplit</span>(<span class="kw">basename</span>(y), <span class="dt">split=</span><span class="st">&quot;_&quot;</span>)[[<span class="dv">1</span>]][<span class="dv">1</span>]</a>
<a class="sourceLine" id="cb12-28" data-line-number="28">    data_total_area_sum<span class="op">$</span>var &lt;-<span class="st"> </span>x</a>
<a class="sourceLine" id="cb12-29" data-line-number="29">    <span class="kw">return</span>(data_total_area_sum)</a>
<a class="sourceLine" id="cb12-30" data-line-number="30">  })</a>
<a class="sourceLine" id="cb12-31" data-line-number="31">  data_crop_areas &lt;-<span class="st"> </span><span class="kw">do.call</span>(<span class="st">&quot;rbind&quot;</span>, data_total_area_sum)</a>
<a class="sourceLine" id="cb12-32" data-line-number="32">  <span class="kw">return</span>(data_crop_areas)</a>
<a class="sourceLine" id="cb12-33" data-line-number="33">})</a>
<a class="sourceLine" id="cb12-34" data-line-number="34">data_crop_areas &lt;-<span class="st"> </span><span class="kw">do.call</span>(<span class="st">&quot;rbind&quot;</span>, data_crop_areas)</a>
<a class="sourceLine" id="cb12-35" data-line-number="35"></a>
<a class="sourceLine" id="cb12-36" data-line-number="36">varnames &lt;-<span class="st"> </span><span class="kw">c</span>(<span class="st">&quot;biofuel_cropland_irrigated&quot;</span>, <span class="st">&quot;biofuel_cropland_rainfed&quot;</span>)</a>
<a class="sourceLine" id="cb12-37" data-line-number="37">data_bio_crop_areas &lt;-<span class="st"> </span><span class="kw">lapply</span>(varnames, <span class="cf">function</span>(x){</a>
<a class="sourceLine" id="cb12-38" data-line-number="38">  data_total_area_sum &lt;-<span class="st"> </span><span class="kw">lapply</span>(data_total[<span class="kw">c</span>(<span class="dv">4</span>,<span class="dv">6</span>,<span class="dv">7</span>)], <span class="cf">function</span>(y){</a>
<a class="sourceLine" id="cb12-39" data-line-number="39">    data &lt;-<span class="st"> </span>raster<span class="op">::</span><span class="kw">stack</span>(y, <span class="dt">varname=</span>x)</a>
<a class="sourceLine" id="cb12-40" data-line-number="40">    data_total_area &lt;-<span class="st"> </span>data<span class="op">*</span>isimip_area</a>
<a class="sourceLine" id="cb12-41" data-line-number="41">    data_total_area_sum &lt;-<span class="st"> </span><span class="kw">as.data.frame</span>(raster<span class="op">::</span><span class="kw">cellStats</span>(data_total_area, <span class="dt">stat=</span><span class="st">'sum'</span>, <span class="dt">na.rm=</span><span class="ot">TRUE</span>))</a>
<a class="sourceLine" id="cb12-42" data-line-number="42">    <span class="kw">colnames</span>(data_total_area_sum)[<span class="dv">1</span>]  &lt;-<span class="st"> &quot;area&quot;</span></a>
<a class="sourceLine" id="cb12-43" data-line-number="43">    nc &lt;-<span class="st"> </span>ncdf4<span class="op">::</span><span class="kw">nc_open</span>(y)</a>
<a class="sourceLine" id="cb12-44" data-line-number="44">    timeref &lt;-<span class="st"> </span>lubridate<span class="op">::</span><span class="kw">year</span>(<span class="kw">strsplit</span>(nc<span class="op">$</span>dim[[<span class="st">&quot;time&quot;</span>]]<span class="op">$</span>units, <span class="st">&quot; &quot;</span>)[[<span class="dv">1</span>]][<span class="dv">3</span>]) </a>
<a class="sourceLine" id="cb12-45" data-line-number="45">    <span class="cf">if</span>(ncdf4<span class="op">::</span><span class="kw">ncvar_get</span>(nc, nc<span class="op">$</span>dim<span class="op">$</span>time)[<span class="dv">1</span>] <span class="op">==</span><span class="st"> </span><span class="dv">0</span>){</a>
<a class="sourceLine" id="cb12-46" data-line-number="46">      data_total_area_sum<span class="op">$</span>year &lt;-<span class="st"> </span>timeref <span class="op">+</span><span class="st"> </span>ncdf4<span class="op">::</span><span class="kw">ncvar_get</span>(nc, nc<span class="op">$</span>dim<span class="op">$</span>time)</a>
<a class="sourceLine" id="cb12-47" data-line-number="47">    } <span class="cf">else</span> <span class="cf">if</span> (ncdf4<span class="op">::</span><span class="kw">ncvar_get</span>(nc, nc<span class="op">$</span>dim<span class="op">$</span>time)[<span class="dv">1</span>] <span class="op">!=</span><span class="st"> </span><span class="dv">0</span>){</a>
<a class="sourceLine" id="cb12-48" data-line-number="48">      data_total_area_sum<span class="op">$</span>year &lt;-<span class="st"> </span>timeref <span class="op">+</span><span class="st"> </span>ncdf4<span class="op">::</span><span class="kw">ncvar_get</span>(nc, nc<span class="op">$</span>dim<span class="op">$</span>time) <span class="op">-</span><span class="st"> </span><span class="dv">1</span></a>
<a class="sourceLine" id="cb12-49" data-line-number="49">    }</a>
<a class="sourceLine" id="cb12-50" data-line-number="50">    ncdf4<span class="op">::</span><span class="kw">nc_close</span>(nc)</a>
<a class="sourceLine" id="cb12-51" data-line-number="51">    data_total_area_sum<span class="op">$</span>scenario &lt;-<span class="st"> </span><span class="kw">strsplit</span>(<span class="kw">basename</span>(y), <span class="dt">split=</span><span class="st">&quot;_&quot;</span>)[[<span class="dv">1</span>]][<span class="dv">1</span>]</a>
<a class="sourceLine" id="cb12-52" data-line-number="52">    data_total_area_sum<span class="op">$</span>var &lt;-<span class="st"> </span>x</a>
<a class="sourceLine" id="cb12-53" data-line-number="53">    <span class="kw">return</span>(data_total_area_sum)</a>
<a class="sourceLine" id="cb12-54" data-line-number="54">  })</a>
<a class="sourceLine" id="cb12-55" data-line-number="55">  data_crop_areas &lt;-<span class="st"> </span><span class="kw">do.call</span>(<span class="st">&quot;rbind&quot;</span>, data_total_area_sum)</a>
<a class="sourceLine" id="cb12-56" data-line-number="56">  <span class="kw">return</span>(data_crop_areas)</a>
<a class="sourceLine" id="cb12-57" data-line-number="57">})</a>
<a class="sourceLine" id="cb12-58" data-line-number="58">data_bio_crop_areas &lt;-<span class="st"> </span><span class="kw">do.call</span>(<span class="st">&quot;rbind&quot;</span>, data_bio_crop_areas)</a>
<a class="sourceLine" id="cb12-59" data-line-number="59"></a>
<a class="sourceLine" id="cb12-60" data-line-number="60">data_crop_areas &lt;-<span class="st"> </span>dplyr<span class="op">::</span><span class="kw">bind_rows</span>(data_crop_areas, data_bio_crop_areas) </a>
<a class="sourceLine" id="cb12-61" data-line-number="61"></a>
<a class="sourceLine" id="cb12-62" data-line-number="62"><span class="co"># Turn into raster files</span></a>
<a class="sourceLine" id="cb12-63" data-line-number="63">data_urban_areas &lt;-<span class="st"> </span><span class="kw">lapply</span>(data_urban, <span class="cf">function</span>(x){</a>
<a class="sourceLine" id="cb12-64" data-line-number="64">  data &lt;-<span class="st"> </span>raster<span class="op">::</span><span class="kw">stack</span>(x)</a>
<a class="sourceLine" id="cb12-65" data-line-number="65">  data_urban_ts &lt;-<span class="st"> </span><span class="kw">as.data.frame</span>(raster<span class="op">::</span><span class="kw">cellStats</span>(data<span class="op">*</span>isimip_area, <span class="dt">stat=</span><span class="st">'sum'</span>, <span class="dt">na.rm=</span><span class="ot">TRUE</span>))</a>
<a class="sourceLine" id="cb12-66" data-line-number="66">  nc &lt;-<span class="st"> </span>ncdf4<span class="op">::</span><span class="kw">nc_open</span>(x)</a>
<a class="sourceLine" id="cb12-67" data-line-number="67">  timeref &lt;-<span class="st"> </span>lubridate<span class="op">::</span><span class="kw">year</span>(<span class="kw">strsplit</span>(nc<span class="op">$</span>dim[[<span class="st">&quot;time&quot;</span>]]<span class="op">$</span>units, <span class="st">&quot; &quot;</span>)[[<span class="dv">1</span>]][<span class="dv">3</span>]) </a>
<a class="sourceLine" id="cb12-68" data-line-number="68">  <span class="cf">if</span>(ncdf4<span class="op">::</span><span class="kw">ncvar_get</span>(nc, nc<span class="op">$</span>dim<span class="op">$</span>time)[<span class="dv">1</span>] <span class="op">==</span><span class="st"> </span><span class="dv">0</span>){</a>
<a class="sourceLine" id="cb12-69" data-line-number="69">    data_urban_ts<span class="op">$</span>year &lt;-<span class="st"> </span>timeref <span class="op">+</span><span class="st"> </span>ncdf4<span class="op">::</span><span class="kw">ncvar_get</span>(nc, nc<span class="op">$</span>dim<span class="op">$</span>time)</a>
<a class="sourceLine" id="cb12-70" data-line-number="70">  } <span class="cf">else</span> <span class="cf">if</span> (ncdf4<span class="op">::</span><span class="kw">ncvar_get</span>(nc, nc<span class="op">$</span>dim<span class="op">$</span>time)[<span class="dv">1</span>] <span class="op">!=</span><span class="st"> </span><span class="dv">0</span>){</a>
<a class="sourceLine" id="cb12-71" data-line-number="71">    data_urban_ts<span class="op">$</span>year &lt;-<span class="st"> </span>timeref <span class="op">+</span><span class="st"> </span>ncdf4<span class="op">::</span><span class="kw">ncvar_get</span>(nc, nc<span class="op">$</span>dim<span class="op">$</span>time) <span class="op">-</span><span class="st"> </span><span class="dv">1</span></a>
<a class="sourceLine" id="cb12-72" data-line-number="72">  }</a>
<a class="sourceLine" id="cb12-73" data-line-number="73">  ncdf4<span class="op">::</span><span class="kw">nc_close</span>(nc)</a>
<a class="sourceLine" id="cb12-74" data-line-number="74">  data_urban_ts<span class="op">$</span>var &lt;-<span class="st"> &quot;urbanareas&quot;</span></a>
<a class="sourceLine" id="cb12-75" data-line-number="75">  <span class="kw">colnames</span>(data_urban_ts)[<span class="dv">1</span>] &lt;-<span class="st"> &quot;area&quot;</span></a>
<a class="sourceLine" id="cb12-76" data-line-number="76">  data_urban_ts<span class="op">$</span>scenario &lt;-<span class="st"> </span><span class="kw">strsplit</span>(<span class="kw">basename</span>(x), <span class="dt">split=</span><span class="st">&quot;_&quot;</span>)[[<span class="dv">1</span>]][<span class="dv">1</span>]</a>
<a class="sourceLine" id="cb12-77" data-line-number="77">  <span class="kw">return</span>(data_urban_ts)</a>
<a class="sourceLine" id="cb12-78" data-line-number="78">})</a>
<a class="sourceLine" id="cb12-79" data-line-number="79">data_urban_areas &lt;-<span class="st"> </span><span class="kw">do.call</span>(<span class="st">&quot;rbind&quot;</span>, data_urban_areas)</a></code></pre></div>
<p>Plot time series</p>
<div class="sourceCode" id="cb13"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb13-1" data-line-number="1">data_ts &lt;-<span class="st"> </span>dplyr<span class="op">::</span><span class="kw">bind_rows</span>(data_crop_areas, data_urban_areas)</a>
<a class="sourceLine" id="cb13-2" data-line-number="2">data_ts<span class="op">$</span>scenario[data_ts<span class="op">$</span>scenario <span class="op">==</span><span class="st"> &quot;2100rcp26soc&quot;</span>] &lt;-<span class="st"> &quot;rcp26&quot;</span></a>
<a class="sourceLine" id="cb13-3" data-line-number="3">data_ts<span class="op">$</span>scenario[data_ts<span class="op">$</span>scenario <span class="op">==</span><span class="st"> &quot;rcp26soc&quot;</span>] &lt;-<span class="st"> &quot;rcp26&quot;</span></a>
<a class="sourceLine" id="cb13-4" data-line-number="4">data_ts<span class="op">$</span>scenario[data_ts<span class="op">$</span>scenario <span class="op">==</span><span class="st"> &quot;rcp60soc&quot;</span>] &lt;-<span class="st"> &quot;rcp60&quot;</span></a>
<a class="sourceLine" id="cb13-5" data-line-number="5">data_ind &lt;-<span class="st"> </span>data_ts[data_ts<span class="op">$</span>var <span class="op">!=</span><span class="st"> &quot;cropland_total&quot;</span>,]</a>
<a class="sourceLine" id="cb13-6" data-line-number="6"></a>
<a class="sourceLine" id="cb13-7" data-line-number="7"><span class="kw">ggplot</span>(<span class="dt">data =</span> data_ind, <span class="kw">aes</span>(<span class="dt">x =</span> year, <span class="dt">y =</span> area<span class="op">/</span><span class="dv">1000000</span>, <span class="dt">colour =</span> <span class="kw">factor</span>(var), <span class="dt">linetype=</span><span class="kw">factor</span>(scenario))) <span class="op">+</span></a>
<a class="sourceLine" id="cb13-8" data-line-number="8"><span class="st">  </span><span class="kw">scale_colour_discrete</span>(<span class="dt">name=</span><span class="st">&quot;Landuse type&quot;</span>, <span class="dt">labels=</span><span class="kw">c</span>(<span class="st">&quot;Biofuel cropland irrigated&quot;</span>, <span class="st">&quot;Biofuel cropland rainfed&quot;</span>, <span class="st">&quot;Cropland irrigated&quot;</span>, <span class="st">&quot;Cropland rainfed&quot;</span>, <span class="st">&quot;Pastures&quot;</span>, <span class="st">&quot;Urban areas&quot;</span>)) <span class="op">+</span><span class="st"> </span></a>
<a class="sourceLine" id="cb13-9" data-line-number="9"><span class="st">  </span><span class="kw">labs</span>(<span class="dt">x=</span> <span class="st">&quot;Year&quot;</span>, <span class="dt">y=</span><span class="st">&quot;Area (kmÂ² x 1,000,000)&quot;</span>) <span class="op">+</span><span class="st"> </span><span class="kw">scale_linetype_discrete</span>(<span class="dt">name=</span><span class="st">&quot;Scenario&quot;</span>) <span class="op">+</span><span class="st"> </span></a>
<a class="sourceLine" id="cb13-10" data-line-number="10"><span class="st">  </span><span class="kw">geom_line</span>() <span class="op">+</span><span class="st"> </span><span class="kw">theme_bw</span>() <span class="op">+</span><span class="st"> </span><span class="kw">theme</span>(<span class="dt">strip.background=</span> <span class="kw">element_blank</span>())</a>
<a class="sourceLine" id="cb13-11" data-line-number="11"></a>
<a class="sourceLine" id="cb13-12" data-line-number="12">data_total &lt;-<span class="st"> </span>data_ts[<span class="op">!</span>data_ts<span class="op">$</span>var <span class="op">%in%</span><span class="st"> </span><span class="kw">c</span>(<span class="st">&quot;biofuel_cropland_irrigated&quot;</span>, </a>
<a class="sourceLine" id="cb13-13" data-line-number="13">                                          <span class="st">&quot;biofuel_cropland_rainfed&quot;</span>, </a>
<a class="sourceLine" id="cb13-14" data-line-number="14">                                          <span class="st">&quot;cropland_irrigated&quot;</span>, <span class="st">&quot;cropland_rainfed&quot;</span>),]</a>
<a class="sourceLine" id="cb13-15" data-line-number="15"><span class="kw">ggplot</span>(<span class="dt">data =</span> data_total, </a>
<a class="sourceLine" id="cb13-16" data-line-number="16">       <span class="kw">aes</span>(<span class="dt">x =</span> year, <span class="dt">y =</span> area<span class="op">/</span><span class="dv">1000000</span>, <span class="dt">colour =</span> <span class="kw">factor</span>(var), <span class="dt">linetype=</span><span class="kw">factor</span>(scenario))) <span class="op">+</span><span class="st"> </span></a>
<a class="sourceLine" id="cb13-17" data-line-number="17"><span class="st">  </span><span class="kw">scale_colour_discrete</span>(<span class="dt">name=</span><span class="st">&quot;Landuse type&quot;</span>, </a>
<a class="sourceLine" id="cb13-18" data-line-number="18">                        <span class="dt">labels=</span><span class="kw">c</span>(<span class="st">&quot;Cropland total&quot;</span>, <span class="st">&quot;Pastures&quot;</span>, <span class="st">&quot;Urban areas&quot;</span>)) <span class="op">+</span><span class="st"> </span></a>
<a class="sourceLine" id="cb13-19" data-line-number="19"><span class="st">  </span><span class="kw">scale_linetype_discrete</span>(<span class="dt">name=</span><span class="st">&quot;Scenario&quot;</span>) <span class="op">+</span><span class="st">  </span></a>
<a class="sourceLine" id="cb13-20" data-line-number="20"><span class="st">  </span><span class="kw">labs</span>(<span class="dt">x=</span> <span class="st">&quot;Year&quot;</span>, <span class="dt">y=</span><span class="st">&quot;Area (kmÂ² x 1,000,000)&quot;</span>) <span class="op">+</span><span class="st"> </span></a>
<a class="sourceLine" id="cb13-21" data-line-number="21"><span class="st">  </span><span class="kw">geom_line</span>() <span class="op">+</span><span class="st"> </span><span class="kw">theme_bw</span>() <span class="op">+</span><span class="st"> </span><span class="kw">scale_x_continuous</span>(<span class="dt">breaks=</span><span class="kw">c</span>(<span class="dv">1700</span>,<span class="dv">1800</span>,<span class="dv">1900</span>,<span class="dv">2000</span>,<span class="dv">2100</span>,<span class="dv">2200</span>)) <span class="op">+</span><span class="st"> </span></a>
<a class="sourceLine" id="cb13-22" data-line-number="22"><span class="st">  </span><span class="kw">theme</span>(<span class="dt">strip.background=</span> <span class="kw">element_blank</span>())</a></code></pre></div>
</div>
</div>



<!-- code folding -->


<!-- dynamically load mathjax for compatibility with self-contained -->
<script>
  (function () {
    var script = document.createElement("script");
    script.type = "text/javascript";
    script.src  = "https://mathjax.rstudio.com/latest/MathJax.js?config=TeX-AMS-MML_HTMLorMML";
    document.getElementsByTagName("head")[0].appendChild(script);
  })();
</script>

</body>
</html>
